import{a as C,j as e}from"./index-DNHKrThd.js";import{r as i}from"./react-vendor-BpgKpUzx.js";import{z as l,I as A,g as Y,c as G,O as H,Q,X}from"./ui-vendor-yLLZ9URH.js";import{S as J}from"./SkeletonLoader-DMsGFzU7.js";import{P as K}from"./Pagination-MtMwbbp0.js";import{C as U}from"./ConfirmDialog-DmvZqo8B.js";import"./pdf-vendor-BOaogWDS.js";const ne=()=>{var I;const[S,R]=i.useState([]),[z,w]=i.useState(!0),[m,B]=i.useState(""),[v,E]=i.useState(1),[p]=i.useState(10),[q,h]=i.useState(!1),[x,W]=i.useState(null),[f,u]=i.useState({isOpen:!1,checklist:null}),[n,d]=i.useState({name:"",description:"",category:"",active:!0}),[a,y]=i.useState([]),[s,g]=i.useState({description:"",item_type:"check",required:!1});i.useEffect(()=>{k()},[m]);const k=async()=>{try{w(!0);const t=await C.get("/checklists");R(t.data)}catch(t){l.error("Erro ao carregar checklists"),console.error(t)}finally{w(!1)}},b=()=>{d({name:"",description:"",category:"",active:!0}),y([]),g({description:"",item_type:"check",required:!1}),W(null)},D=async t=>{var r,o;t.preventDefault();try{const j={...n,items:a.map((V,$)=>({...V,sort_order:$}))};x?(await C.put(`/checklists/${x.id}`,j),l.success("Checklist atualizado com sucesso!")):(await C.post("/checklists",j),l.success("Checklist criado com sucesso!")),h(!1),b(),k()}catch(j){l.error(((o=(r=j.response)==null?void 0:r.data)==null?void 0:o.error)||"Erro ao salvar checklist")}},O=t=>{var r;W(t),d({name:t.name,description:t.description||"",category:t.category||"",active:t.active}),y(((r=t.items)==null?void 0:r.map(o=>({description:o.description,item_type:o.item_type,required:o.required})))||[]),h(!0)},T=t=>{u({isOpen:!0,checklist:t})},_=async()=>{if(f.checklist)try{await C.delete(`/checklists/${f.checklist.id}`),l.success("Checklist excluído com sucesso!"),u({isOpen:!1,checklist:null}),k()}catch{l.error("Erro ao excluir checklist"),u({isOpen:!1,checklist:null})}},P=()=>{if(!s.description.trim()){l.error("Descrição é obrigatória");return}const t={description:s.description,item_type:s.item_type,required:s.required};y([...a,t]),g({description:"",item_type:"check",required:!1})},L=t=>{y(a.filter((r,o)=>o!==t))},M=t=>{switch(t){case"check":return"Verificação";case"measure":return"Medição";case"observation":return"Observação";default:return t}},c=i.useMemo(()=>S.filter(t=>{if(m){const r=m.toLowerCase();return t.name.toLowerCase().includes(r)||t.description&&t.description.toLowerCase().includes(r)||t.category&&t.category.toLowerCase().includes(r)}return!0}),[S,m]),N=i.useMemo(()=>{const t=(v-1)*p;return c.slice(t,t+p)},[c,v,p]),F=Math.ceil(c.length/p);return e.jsxs("div",{children:[e.jsxs("div",{style:{marginBottom:"2rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsx("h1",{style:{fontSize:"1.875rem",fontWeight:"bold",color:"#1e293b",marginBottom:"0.5rem"},children:"Checklists"}),e.jsx("p",{style:{color:"#64748b",fontSize:"0.9rem"},children:"Gerencie listas de verificação para padronizar serviços"})]}),e.jsxs("button",{onClick:()=>{b(),h(!0)},style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.75rem 1.5rem",backgroundColor:"#f97316",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:"600"},children:[e.jsx(A,{size:20}),"Novo Checklist"]})]}),e.jsx("div",{style:{marginBottom:"1.5rem"},children:e.jsxs("div",{style:{position:"relative",maxWidth:"400px"},children:[e.jsx(Y,{size:20,style:{position:"absolute",left:"12px",top:"50%",transform:"translateY(-50%)",color:"#64748b"}}),e.jsx("input",{type:"text",placeholder:"Buscar checklists...",value:m,onChange:t=>B(t.target.value),style:{width:"100%",padding:"0.75rem 1rem 0.75rem 2.5rem",border:"1px solid #e2e8f0",borderRadius:"8px",fontSize:"0.9rem",outline:"none"}})]})}),e.jsx("div",{style:{backgroundColor:"white",borderRadius:"12px",boxShadow:"0 1px 3px 0 rgb(0 0 0 / 0.1)",overflow:"hidden"},children:z?e.jsx(J,{type:"table"}):c.length===0?e.jsx("div",{style:{padding:"3rem",textAlign:"center",color:"#64748b"},children:"Nenhum checklist encontrado"}):e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{backgroundColor:"#f8fafc",borderBottom:"1px solid #e2e8f0"},children:[e.jsx("th",{style:{padding:"1rem",textAlign:"left",fontSize:"0.875rem",fontWeight:"600",color:"#64748b"},children:"Nome"}),e.jsx("th",{style:{padding:"1rem",textAlign:"left",fontSize:"0.875rem",fontWeight:"600",color:"#64748b"},children:"Descrição"}),e.jsx("th",{style:{padding:"1rem",textAlign:"left",fontSize:"0.875rem",fontWeight:"600",color:"#64748b"},children:"Categoria"}),e.jsx("th",{style:{padding:"1rem",textAlign:"center",fontSize:"0.875rem",fontWeight:"600",color:"#64748b"},children:"Itens"}),e.jsx("th",{style:{padding:"1rem",textAlign:"center",fontSize:"0.875rem",fontWeight:"600",color:"#64748b"},children:"Status"}),e.jsx("th",{style:{padding:"1rem",textAlign:"center",fontSize:"0.875rem",fontWeight:"600",color:"#64748b"},children:"Ações"})]})}),e.jsx("tbody",{children:N.map(t=>{var r;return e.jsxs("tr",{style:{borderBottom:"1px solid #e2e8f0",transition:"background-color 0.2s"},onMouseEnter:o=>{o.currentTarget.style.backgroundColor="#f8fafc"},onMouseLeave:o=>{o.currentTarget.style.backgroundColor="white"},children:[e.jsx("td",{style:{padding:"1rem"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx(G,{size:20,color:"#3b82f6"}),e.jsx("span",{style:{fontWeight:"600",color:"#1e293b"},children:t.name})]})}),e.jsx("td",{style:{padding:"1rem",color:"#64748b",fontSize:"0.875rem"},children:t.description||"-"}),e.jsx("td",{style:{padding:"1rem",color:"#64748b",fontSize:"0.875rem"},children:t.category||"-"}),e.jsx("td",{style:{padding:"1rem",textAlign:"center",color:"#64748b",fontSize:"0.875rem"},children:((r=t.items)==null?void 0:r.length)||0}),e.jsx("td",{style:{padding:"1rem",textAlign:"center"},children:e.jsx("span",{style:{fontSize:"0.75rem",padding:"0.25rem 0.75rem",borderRadius:"12px",fontWeight:"600",backgroundColor:t.active?"#10b98120":"#64748b20",color:t.active?"#10b981":"#64748b"},children:t.active?"Ativo":"Inativo"})}),e.jsx("td",{style:{padding:"1rem"},children:e.jsxs("div",{style:{display:"flex",gap:"0.5rem",justifyContent:"center"},children:[e.jsx("button",{onClick:()=>O(t),style:{padding:"0.5rem",backgroundColor:"#f1f5f9",border:"none",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},title:"Editar",children:e.jsx(H,{size:16,color:"#64748b"})}),e.jsx("button",{onClick:()=>T(t),style:{padding:"0.5rem",backgroundColor:"#fee2e2",border:"none",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},title:"Excluir",children:e.jsx(Q,{size:16,color:"#ef4444"})})]})})]},t.id)})})]})}),!z&&c.length>0&&e.jsx(K,{currentPage:v,totalPages:F,onPageChange:E,totalItems:c.length,itemsPerPage:p}),e.jsx(U,{isOpen:f.isOpen,title:"Confirmar Exclusão",message:`Tem certeza que deseja excluir o checklist "${(I=f.checklist)==null?void 0:I.name}"? Esta ação não pode ser desfeita.`,confirmText:"Excluir",cancelText:"Cancelar",type:"danger",onConfirm:_,onCancel:()=>u({isOpen:!1,checklist:null})}),q&&e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:"1rem"},onClick:()=>{h(!1),b()},children:e.jsxs("div",{style:{backgroundColor:"white",borderRadius:"12px",padding:"2rem",width:"90%",maxWidth:"800px",maxHeight:"90vh",overflowY:"auto"},onClick:t=>t.stopPropagation(),children:[e.jsx("h2",{style:{marginBottom:"1.5rem",fontSize:"1.5rem",fontWeight:"bold"},children:x?"Editar Checklist":"Novo Checklist"}),e.jsxs("form",{onSubmit:D,children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr",gap:"1rem",marginBottom:"1rem"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.875rem",fontWeight:"600"},children:"Nome *"}),e.jsx("input",{type:"text",value:n.name,onChange:t=>d({...n,name:t.target.value}),required:!0,style:{width:"100%",padding:"0.75rem",border:"1px solid #e2e8f0",borderRadius:"8px",fontSize:"0.9rem"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.875rem",fontWeight:"600"},children:"Categoria"}),e.jsx("input",{type:"text",value:n.category,onChange:t=>d({...n,category:t.target.value}),placeholder:"Ex: Revisão, Inspeção...",style:{width:"100%",padding:"0.75rem",border:"1px solid #e2e8f0",borderRadius:"8px",fontSize:"0.9rem"}})]})]}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.875rem",fontWeight:"600"},children:"Descrição"}),e.jsx("textarea",{value:n.description,onChange:t=>d({...n,description:t.target.value}),rows:3,style:{width:"100%",padding:"0.75rem",border:"1px solid #e2e8f0",borderRadius:"8px",fontSize:"0.9rem",resize:"vertical"}})]}),e.jsx("div",{style:{marginBottom:"1rem"},children:e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",fontSize:"0.875rem",fontWeight:"600"},children:[e.jsx("input",{type:"checkbox",checked:n.active,onChange:t=>d({...n,active:t.target.checked})}),"Checklist ativo"]})}),e.jsxs("div",{style:{marginBottom:"2rem",padding:"1rem",backgroundColor:"#f8fafc",borderRadius:"8px",border:"1px solid #e2e8f0"},children:[e.jsx("h3",{style:{fontSize:"1rem",fontWeight:"600",marginBottom:"1rem"},children:"Adicionar Item ao Checklist"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 150px 100px",gap:"1rem",marginBottom:"1rem"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.875rem",fontWeight:"600"},children:"Descrição *"}),e.jsx("input",{type:"text",value:s.description,onChange:t=>g({...s,description:t.target.value}),placeholder:"Ex: Verificar nível de óleo",required:!0,style:{width:"100%",padding:"0.75rem",border:"1px solid #e2e8f0",borderRadius:"8px",fontSize:"0.9rem"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.875rem",fontWeight:"600"},children:"Tipo"}),e.jsxs("select",{value:s.item_type,onChange:t=>g({...s,item_type:t.target.value}),style:{width:"100%",padding:"0.75rem",border:"1px solid #e2e8f0",borderRadius:"8px",fontSize:"0.9rem"},children:[e.jsx("option",{value:"check",children:"Verificação"}),e.jsx("option",{value:"measure",children:"Medição"}),e.jsx("option",{value:"observation",children:"Observação"})]})]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",justifyContent:"flex-end"},children:e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",fontSize:"0.875rem",fontWeight:"600",marginBottom:"0.5rem"},children:[e.jsx("input",{type:"checkbox",checked:s.required,onChange:t=>g({...s,required:t.target.checked})}),"Obrigatório"]})})]}),e.jsxs("button",{type:"button",onClick:P,style:{padding:"0.75rem 1.5rem",backgroundColor:"#3b82f6",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:"600",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(A,{size:16}),"Adicionar Item"]})]}),a.length>0&&e.jsxs("div",{style:{marginBottom:"2rem"},children:[e.jsxs("h3",{style:{fontSize:"1rem",fontWeight:"600",marginBottom:"1rem"},children:["Itens do Checklist (",a.length,")"]}),e.jsx("div",{style:{border:"1px solid #e2e8f0",borderRadius:"8px",overflow:"hidden"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{backgroundColor:"#f8fafc"},children:[e.jsx("th",{style:{padding:"0.75rem",textAlign:"left",fontSize:"0.875rem",fontWeight:"600",color:"#64748b"},children:"Descrição"}),e.jsx("th",{style:{padding:"0.75rem",textAlign:"center",fontSize:"0.875rem",fontWeight:"600",color:"#64748b"},children:"Tipo"}),e.jsx("th",{style:{padding:"0.75rem",textAlign:"center",fontSize:"0.875rem",fontWeight:"600",color:"#64748b"},children:"Obrigatório"}),e.jsx("th",{style:{padding:"0.75rem",textAlign:"center",fontSize:"0.875rem",fontWeight:"600",color:"#64748b"},children:"Ações"})]})}),e.jsx("tbody",{children:a.map((t,r)=>e.jsxs("tr",{style:{borderTop:"1px solid #e2e8f0"},children:[e.jsx("td",{style:{padding:"0.75rem",fontSize:"0.875rem",color:"#1e293b"},children:t.description}),e.jsx("td",{style:{padding:"0.75rem",textAlign:"center",fontSize:"0.875rem",color:"#64748b"},children:M(t.item_type)}),e.jsx("td",{style:{padding:"0.75rem",textAlign:"center"},children:t.required?e.jsx("span",{style:{fontSize:"0.75rem",padding:"0.25rem 0.75rem",borderRadius:"12px",fontWeight:"600",backgroundColor:"#ef444420",color:"#ef4444"},children:"Sim"}):e.jsx("span",{style:{fontSize:"0.875rem",color:"#64748b"},children:"Não"})}),e.jsx("td",{style:{padding:"0.75rem",textAlign:"center"},children:e.jsx("button",{type:"button",onClick:()=>L(r),style:{padding:"0.5rem",backgroundColor:"#fee2e2",border:"none",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},title:"Remover",children:e.jsx(X,{size:16,color:"#ef4444"})})})]},r))})]})})]}),e.jsxs("div",{style:{display:"flex",gap:"1rem",justifyContent:"flex-end"},children:[e.jsx("button",{type:"button",onClick:()=>{h(!1),b()},style:{padding:"0.75rem 1.5rem",backgroundColor:"#f1f5f9",color:"#64748b",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:"600"},children:"Cancelar"}),e.jsx("button",{type:"submit",style:{padding:"0.75rem 1.5rem",backgroundColor:"#f97316",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:"600"},children:x?"Atualizar":"Criar"})]})]})]})})]})};export{ne as default};
