import{a as u,j as e}from"./index-DNHKrThd.js";import{h as ze,r as d}from"./react-vendor-BpgKpUzx.js";import{z as s,x as we,t as ke,D as Re,I as ne,O as ie,Q as se,X as Be}from"./ui-vendor-yLLZ9URH.js";import{S as E}from"./SkeletonLoader-DMsGFzU7.js";import"./pdf-vendor-BOaogWDS.js";const Ae=()=>{var K,Z,ee,te,re,oe,ae;const[$,V]=ze(),l=$.get("order_id"),M=$.get("tab"),[f,P]=d.useState(M||"dashboard"),[y,de]=d.useState(null),[q,le]=d.useState([]),[L,ce]=d.useState([]),[me,pe]=d.useState([]),[ue,ge]=d.useState([]),[A,v]=d.useState(!0),[he,C]=d.useState(!1),[xe,S]=d.useState(!1),[R,N]=d.useState(null),[_,H]=d.useState(null),[a,x]=d.useState({supplier_id:"",description:"",category:"",due_date:"",amount:"",paid_amount:"0",payment_date:"",payment_method:"",status:"open",notes:""}),[o,g]=d.useState({client_id:"",description:"",due_date:"",amount:"",paid_amount:"0",payment_date:"",payment_method:"",status:"open",notes:""}),[b,X]=d.useState(!1),[c,z]=d.useState([]),[Y,G]=d.useState(2);d.useEffect(()=>{l&&(P("receivables"),fe(parseInt(l))),f==="dashboard"?w():f==="payables"?(T(),be()):f==="receivables"&&(B(),ye())},[f,l,M]);const fe=async t=>{var r;try{const i=(await u.get(`/orders/${t}`)).data,j=(await u.get(`/financial/receivables?order_id=${t}`)).data;if(j.length>0){s(`Já existe ${j.length} conta(s) a receber para esta OS.`,{duration:5e3,icon:"ℹ️"});return}g({client_id:i.client_id.toString(),description:`OS #${i.order_number} - ${i.client_name||""} - ${i.brand||""} ${i.model||""} ${i.plate?`(${i.plate})`:""}`,due_date:new Date().toISOString().split("T")[0],amount:((r=i.total)==null?void 0:r.toString())||"0",paid_amount:"0",payment_date:"",payment_method:"",status:"open",notes:`Gerada automaticamente da OS #${i.order_number}`}),S(!0),s.success("Formulário preenchido com dados da OS. Complete e salve para criar a conta a receber.",{duration:5e3})}catch(n){console.error("Erro ao carregar dados da OS:",n),s.error("Erro ao carregar dados da ordem de serviço")}},w=async()=>{try{v(!0);const t=await u.get("/financial/dashboard");de(t.data)}catch(t){s.error("Erro ao carregar dashboard financeiro"),console.error(t)}finally{v(!1)}},T=async()=>{try{v(!0);const t=await u.get("/financial/payables");le(t.data)}catch(t){s.error("Erro ao carregar contas a pagar"),console.error(t)}finally{v(!1)}},B=async()=>{try{v(!0);const t=l?`/financial/receivables?order_id=${l}`:"/financial/receivables",r=await u.get(t);ce(r.data),l&&r.data.length>0&&s.success(`Encontradas ${r.data.length} conta(s) a receber vinculada(s) a esta ordem`,{duration:5e3})}catch(t){s.error("Erro ao carregar contas a receber"),console.error(t)}finally{v(!1)}},be=async()=>{try{const t=await u.get("/suppliers");pe(t.data)}catch(t){console.error("Erro ao carregar fornecedores:",t)}},ye=async()=>{try{const t=await u.get("/clients");ge(t.data)}catch(t){console.error("Erro ao carregar clientes:",t)}},je=async t=>{var r,n;t.preventDefault();try{const i={...a,supplier_id:a.supplier_id?parseInt(a.supplier_id):null,amount:parseFloat(a.amount),paid_amount:parseFloat(a.paid_amount)||0,due_date:new Date(a.due_date).toISOString(),payment_date:a.payment_date?new Date(a.payment_date).toISOString():null,category:a.category||null,payment_method:a.payment_method||null,notes:a.notes||null};R?(await u.put(`/financial/payables/${R.id}`,i),s.success("Conta a pagar atualizada com sucesso!")):(await u.post("/financial/payables",i),s.success("Conta a pagar criada com sucesso!")),C(!1),W(),T(),w()}catch(i){s.error(((n=(r=i.response)==null?void 0:r.data)==null?void 0:n.error)||"Erro ao salvar conta a pagar")}},ve=async t=>{var r,n,i;t.preventDefault();try{const p=parseFloat(o.amount);if(b&&c.length>0){const h=c.reduce((k,O)=>k+parseFloat(O.amount.toString()),0);if(Math.abs(h-p)>.01){s.error(`A soma das parcelas (${m(h)}) deve ser igual ao valor total (${m(p)})`);return}}const j={...o,client_id:parseInt(o.client_id),amount:p,paid_amount:b?0:parseFloat(o.paid_amount)||0,due_date:b?((r=c[0])==null?void 0:r.due_date)||new Date().toISOString():new Date(o.due_date).toISOString(),payment_date:o.payment_date?new Date(o.payment_date).toISOString():null,payment_method:o.payment_method||null,notes:o.notes||null,order_id:l?parseInt(l):void 0,installments:b&&c.length>0?c.map(h=>({due_date:new Date(h.due_date).toISOString(),amount:parseFloat(h.amount.toString()),payment_method:h.payment_method||null,notes:null})):void 0};_?(await u.put(`/financial/receivables/${_.id}`,j),s.success("Conta a receber atualizada com sucesso!")):(await u.post("/financial/receivables",j),s.success("Conta a receber criada com sucesso!")),S(!1),D(),l&&V({}),B(),w()}catch(p){s.error(((i=(n=p.response)==null?void 0:n.data)==null?void 0:i.error)||"Erro ao salvar conta a receber")}},Se=async t=>{if(confirm("Tem certeza que deseja excluir esta conta a pagar?"))try{await u.delete(`/financial/payables/${t}`),s.success("Conta a pagar excluída com sucesso!"),T(),w()}catch{s.error("Erro ao excluir conta a pagar")}},_e=async t=>{if(confirm("Tem certeza que deseja excluir esta conta a receber?"))try{await u.delete(`/financial/receivables/${t}`),s.success("Conta a receber excluída com sucesso!"),B(),w()}catch{s.error("Erro ao excluir conta a receber")}},W=()=>{x({supplier_id:"",description:"",category:"",due_date:"",amount:"",paid_amount:"0",payment_date:"",payment_method:"",status:"open",notes:""}),N(null)},D=()=>{g({client_id:"",description:"",due_date:"",amount:"",paid_amount:"0",payment_date:"",payment_method:"",status:"open",notes:""}),H(null),X(!1),z([]),G(2)},Ce=()=>{const t=parseFloat(o.amount);if(!t||t<=0){s.error("Informe o valor total primeiro");return}const r=Y,n=Math.floor(t/r*100)/100,i=Math.round((t-n*r)*100)/100,p=[],j=o.due_date?new Date(o.due_date):new Date;for(let h=0;h<r;h++){const k=new Date(j);k.setMonth(k.getMonth()+h);const O=h===0?n+i:n;p.push({installment_number:h+1,due_date:k.toISOString().split("T")[0],amount:O,paid_amount:0,status:"open"})}z(p)},U=(t,r,n)=>{const i=[...c];i[t][r]=n,z(i)},m=t=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(t),I=t=>new Date(t).toLocaleDateString("pt-BR"),F=t=>({open:"#f59e0b",paid:"#10b981",overdue:"#ef4444",cancelled:"#64748b"})[t]||"#64748b",J=t=>({open:"Aberta",paid:"Paga",overdue:"Vencida",cancelled:"Cancelada"})[t]||t,Q=(t,r)=>r==="paid"||r==="cancelled"?!1:new Date(t)<new Date;return e.jsxs("div",{children:[e.jsxs("div",{style:{marginBottom:"2rem"},children:[e.jsx("h1",{style:{fontSize:"1.875rem",fontWeight:"bold",color:"#1e293b",marginBottom:"0.5rem"},children:"Financeiro"}),e.jsx("p",{style:{color:"#64748b",fontSize:"0.9rem"},children:"Controle financeiro completo da oficina"})]}),e.jsx("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"2rem",borderBottom:"2px solid #e2e8f0"},children:[{id:"dashboard",label:"Dashboard"},{id:"payables",label:"Contas a Pagar"},{id:"receivables",label:"Contas a Receber"}].map(t=>e.jsx("button",{onClick:()=>P(t.id),style:{padding:"0.75rem 1.5rem",border:"none",backgroundColor:"transparent",borderBottom:f===t.id?"2px solid #f97316":"2px solid transparent",cursor:"pointer",fontWeight:f===t.id?"600":"400",color:f===t.id?"#f97316":"#64748b"},children:t.label},t.id))}),f==="dashboard"&&e.jsx("div",{children:A?e.jsx(E,{type:"card"}):y?e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"1.5rem",marginBottom:"2rem"},children:[e.jsxs("div",{style:{padding:"1.5rem",backgroundColor:"white",borderRadius:"12px",boxShadow:"0 1px 3px 0 rgb(0 0 0 / 0.1)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"1rem"},children:[e.jsx("div",{style:{padding:"0.5rem",backgroundColor:"#fee2e220",borderRadius:"8px"},children:e.jsx(we,{size:24,color:"#ef4444"})}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.875rem",color:"#64748b"},children:"Contas a Pagar"}),e.jsx("div",{style:{fontSize:"1.5rem",fontWeight:"bold",color:"#1e293b"},children:m(parseFloat(((K=y.payables)==null?void 0:K.total_open)||"0"))})]})]}),e.jsxs("div",{style:{fontSize:"0.75rem",color:"#64748b"},children:["Vencidas: ",m(parseFloat(((Z=y.payables)==null?void 0:Z.total_overdue)||"0"))]})]}),e.jsxs("div",{style:{padding:"1.5rem",backgroundColor:"white",borderRadius:"12px",boxShadow:"0 1px 3px 0 rgb(0 0 0 / 0.1)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"1rem"},children:[e.jsx("div",{style:{padding:"0.5rem",backgroundColor:"#f0fdf420",borderRadius:"8px"},children:e.jsx(ke,{size:24,color:"#10b981"})}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.875rem",color:"#64748b"},children:"Contas a Receber"}),e.jsx("div",{style:{fontSize:"1.5rem",fontWeight:"bold",color:"#1e293b"},children:m(parseFloat(((ee=y.receivables)==null?void 0:ee.total_open)||"0"))})]})]}),e.jsxs("div",{style:{fontSize:"0.75rem",color:"#64748b"},children:["Vencidas: ",m(parseFloat(((te=y.receivables)==null?void 0:te.total_overdue)||"0"))]})]}),e.jsxs("div",{style:{padding:"1.5rem",backgroundColor:"white",borderRadius:"12px",boxShadow:"0 1px 3px 0 rgb(0 0 0 / 0.1)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"1rem"},children:[e.jsx("div",{style:{padding:"0.5rem",backgroundColor:"#eff6ff20",borderRadius:"8px"},children:e.jsx(Re,{size:24,color:"#3b82f6"})}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.875rem",color:"#64748b"},children:"Saldo do Mês"}),e.jsx("div",{style:{fontSize:"1.5rem",fontWeight:"bold",color:"#1e293b"},children:m(parseFloat(((re=y.cashFlow)==null?void 0:re.balance)||"0"))})]})]}),e.jsxs("div",{style:{fontSize:"0.75rem",color:"#64748b"},children:["Receitas: ",m(parseFloat(((oe=y.cashFlow)==null?void 0:oe.total_income)||"0"))," | Despesas: ",m(parseFloat(((ae=y.cashFlow)==null?void 0:ae.total_expense)||"0"))]})]})]}):null}),f==="payables"&&e.jsxs("div",{children:[e.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:"1rem"},children:e.jsxs("button",{onClick:()=>{W(),C(!0)},style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.75rem 1.5rem",backgroundColor:"#f97316",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:"600"},children:[e.jsx(ne,{size:20}),"Nova Conta a Pagar"]})}),e.jsx("div",{style:{backgroundColor:"white",borderRadius:"12px",boxShadow:"0 1px 3px 0 rgb(0 0 0 / 0.1)",overflow:"hidden"},children:A?e.jsx(E,{type:"table"}):q.length===0?e.jsx("div",{style:{padding:"3rem",textAlign:"center",color:"#64748b"},children:"Nenhuma conta a pagar encontrada"}):e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{backgroundColor:"#f8fafc",borderBottom:"1px solid #e2e8f0"},children:[e.jsx("th",{style:{padding:"1rem",textAlign:"left",fontSize:"0.875rem",fontWeight:"600",color:"#64748b"},children:"Descrição"}),e.jsx("th",{style:{padding:"1rem",textAlign:"left",fontSize:"0.875rem",fontWeight:"600",color:"#64748b"},children:"Fornecedor"}),e.jsx("th",{style:{padding:"1rem",textAlign:"left",fontSize:"0.875rem",fontWeight:"600",color:"#64748b"},children:"Vencimento"}),e.jsx("th",{style:{padding:"1rem",textAlign:"right",fontSize:"0.875rem",fontWeight:"600",color:"#64748b"},children:"Valor"}),e.jsx("th",{style:{padding:"1rem",textAlign:"right",fontSize:"0.875rem",fontWeight:"600",color:"#64748b"},children:"Pago"}),e.jsx("th",{style:{padding:"1rem",textAlign:"center",fontSize:"0.875rem",fontWeight:"600",color:"#64748b"},children:"Status"}),e.jsx("th",{style:{padding:"1rem",textAlign:"center",fontSize:"0.875rem",fontWeight:"600",color:"#64748b"},children:"Ações"})]})}),e.jsx("tbody",{children:q.map(t=>{const r=Q(t.due_date,t.status);return e.jsxs("tr",{style:{borderBottom:"1px solid #e2e8f0",backgroundColor:r?"#fef2f2":"white"},children:[e.jsx("td",{style:{padding:"1rem",fontWeight:"600"},children:t.description}),e.jsx("td",{style:{padding:"1rem",color:"#64748b"},children:t.supplier_name||"-"}),e.jsx("td",{style:{padding:"1rem",color:"#64748b"},children:I(t.due_date)}),e.jsx("td",{style:{padding:"1rem",textAlign:"right",fontWeight:"600"},children:m(t.amount)}),e.jsx("td",{style:{padding:"1rem",textAlign:"right",color:"#64748b"},children:m(t.paid_amount)}),e.jsx("td",{style:{padding:"1rem",textAlign:"center"},children:e.jsx("span",{style:{padding:"0.25rem 0.75rem",borderRadius:"12px",fontSize:"0.75rem",fontWeight:"600",backgroundColor:F(r?"overdue":t.status)+"20",color:F(r?"overdue":t.status)},children:r?"Vencida":J(t.status)})}),e.jsx("td",{style:{padding:"1rem"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:"0.5rem"},children:[e.jsx("button",{onClick:()=>{var n;N(t),x({supplier_id:((n=t.supplier_id)==null?void 0:n.toString())||"",description:t.description,category:t.category||"",due_date:new Date(t.due_date).toISOString().split("T")[0],amount:t.amount.toString(),paid_amount:t.paid_amount.toString(),payment_date:t.payment_date?new Date(t.payment_date).toISOString().split("T")[0]:"",payment_method:t.payment_method||"",status:t.status,notes:t.notes||""}),C(!0)},style:{padding:"0.5rem",backgroundColor:"#f1f5f9",border:"none",borderRadius:"6px",cursor:"pointer"},children:e.jsx(ie,{size:16,color:"#64748b"})}),e.jsx("button",{onClick:()=>Se(t.id),style:{padding:"0.5rem",backgroundColor:"#fee2e2",border:"none",borderRadius:"6px",cursor:"pointer"},children:e.jsx(se,{size:16,color:"#ef4444"})})]})})]},t.id)})})]})})]}),f==="receivables"&&e.jsxs("div",{children:[l&&e.jsxs("div",{style:{padding:"1rem",backgroundColor:"#fef3c7",border:"1px solid #fbbf24",borderRadius:"8px",marginBottom:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsx("strong",{style:{color:"#92400e"},children:"Filtrado por Ordem de Serviço"}),e.jsxs("div",{style:{fontSize:"0.875rem",color:"#78350f",marginTop:"0.25rem"},children:["Mostrando contas a receber vinculadas à ordem #",l]})]}),e.jsx("button",{onClick:()=>{V({}),P("receivables"),B()},style:{padding:"0.5rem 1rem",backgroundColor:"#fbbf24",color:"#78350f",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"0.875rem",fontWeight:"600"},children:"Remover Filtro"})]}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:"1rem"},children:e.jsxs("button",{onClick:()=>{D(),S(!0)},style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.75rem 1.5rem",backgroundColor:"#f97316",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:"600"},children:[e.jsx(ne,{size:20}),"Nova Conta a Receber"]})}),e.jsx("div",{style:{backgroundColor:"white",borderRadius:"12px",boxShadow:"0 1px 3px 0 rgb(0 0 0 / 0.1)",overflow:"hidden"},children:A?e.jsx(E,{type:"table"}):L.length===0?e.jsx("div",{style:{padding:"3rem",textAlign:"center",color:"#64748b"},children:"Nenhuma conta a receber encontrada"}):e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{backgroundColor:"#f8fafc",borderBottom:"1px solid #e2e8f0"},children:[e.jsx("th",{style:{padding:"1rem",textAlign:"left",fontSize:"0.875rem",fontWeight:"600",color:"#64748b"},children:"Descrição"}),e.jsx("th",{style:{padding:"1rem",textAlign:"left",fontSize:"0.875rem",fontWeight:"600",color:"#64748b"},children:"Cliente"}),e.jsx("th",{style:{padding:"1rem",textAlign:"left",fontSize:"0.875rem",fontWeight:"600",color:"#64748b"},children:"Vencimento"}),e.jsx("th",{style:{padding:"1rem",textAlign:"right",fontSize:"0.875rem",fontWeight:"600",color:"#64748b"},children:"Valor"}),e.jsx("th",{style:{padding:"1rem",textAlign:"right",fontSize:"0.875rem",fontWeight:"600",color:"#64748b"},children:"Recebido"}),e.jsx("th",{style:{padding:"1rem",textAlign:"center",fontSize:"0.875rem",fontWeight:"600",color:"#64748b"},children:"Status"}),e.jsx("th",{style:{padding:"1rem",textAlign:"center",fontSize:"0.875rem",fontWeight:"600",color:"#64748b"},children:"Ações"})]})}),e.jsx("tbody",{children:L.filter(t=>!l||t.order_id===parseInt(l)).map(t=>{const r=Q(t.due_date,t.status),n=l&&t.order_id===parseInt(l);return e.jsxs("tr",{style:{borderBottom:"1px solid #e2e8f0",backgroundColor:n?"#fef3c7":r?"#fef2f2":"white",borderLeft:n?"4px solid #f59e0b":"none"},children:[e.jsxs("td",{style:{padding:"1rem",fontWeight:"600"},children:[t.description,t.installments&&t.installments.length>0&&e.jsxs("div",{style:{fontSize:"0.75rem",color:"#64748b",marginTop:"0.25rem"},children:[t.installments.length," parcela(s)"]})]}),e.jsx("td",{style:{padding:"1rem",color:"#64748b"},children:t.client_name||"-"}),e.jsx("td",{style:{padding:"1rem",color:"#64748b"},children:t.installments&&t.installments.length>0?e.jsxs("div",{children:[e.jsx("div",{children:I(t.installments[0].due_date)}),e.jsxs("div",{style:{fontSize:"0.75rem",color:"#94a3b8"},children:["Última: ",I(t.installments[t.installments.length-1].due_date)]})]}):I(t.due_date)}),e.jsx("td",{style:{padding:"1rem",textAlign:"right",fontWeight:"600"},children:m(t.amount)}),e.jsx("td",{style:{padding:"1rem",textAlign:"right",color:"#64748b"},children:m(t.paid_amount)}),e.jsx("td",{style:{padding:"1rem",textAlign:"center"},children:e.jsx("span",{style:{padding:"0.25rem 0.75rem",borderRadius:"12px",fontSize:"0.75rem",fontWeight:"600",backgroundColor:F(r?"overdue":t.status)+"20",color:F(r?"overdue":t.status)},children:r?"Vencida":J(t.status)})}),e.jsx("td",{style:{padding:"1rem"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:"0.5rem"},children:[e.jsx("button",{onClick:()=>{H(t),g({client_id:t.client_id.toString(),description:t.description,due_date:new Date(t.due_date).toISOString().split("T")[0],amount:t.amount.toString(),paid_amount:t.paid_amount.toString(),payment_date:t.payment_date?new Date(t.payment_date).toISOString().split("T")[0]:"",payment_method:t.payment_method||"",status:t.status,notes:t.notes||""}),S(!0)},style:{padding:"0.5rem",backgroundColor:"#f1f5f9",border:"none",borderRadius:"6px",cursor:"pointer"},children:e.jsx(ie,{size:16,color:"#64748b"})}),e.jsx("button",{onClick:()=>_e(t.id),style:{padding:"0.5rem",backgroundColor:"#fee2e2",border:"none",borderRadius:"6px",cursor:"pointer"},children:e.jsx(se,{size:16,color:"#ef4444"})})]})})]},t.id)})})]})})]}),he&&e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},onClick:()=>{C(!1),W()},children:e.jsxs("div",{style:{backgroundColor:"white",borderRadius:"12px",padding:"2rem",width:"90%",maxWidth:"600px",maxHeight:"90vh",overflowY:"auto"},onClick:t=>t.stopPropagation(),children:[e.jsx("h2",{style:{marginBottom:"1.5rem",fontSize:"1.5rem",fontWeight:"bold"},children:R?"Editar Conta a Pagar":"Nova Conta a Pagar"}),e.jsxs("form",{onSubmit:je,children:[e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.875rem",fontWeight:"600"},children:"Fornecedor"}),e.jsxs("select",{value:a.supplier_id,onChange:t=>x({...a,supplier_id:t.target.value}),style:{width:"100%",padding:"0.75rem",border:"1px solid #e2e8f0",borderRadius:"8px",fontSize:"0.9rem"},children:[e.jsx("option",{value:"",children:"Selecione um fornecedor"}),me.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.875rem",fontWeight:"600"},children:"Descrição *"}),e.jsx("input",{type:"text",value:a.description,onChange:t=>x({...a,description:t.target.value}),required:!0,style:{width:"100%",padding:"0.75rem",border:"1px solid #e2e8f0",borderRadius:"8px",fontSize:"0.9rem"}})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem",marginBottom:"1rem"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.875rem",fontWeight:"600"},children:"Data de Vencimento *"}),e.jsx("input",{type:"date",value:a.due_date,onChange:t=>x({...a,due_date:t.target.value}),required:!0,style:{width:"100%",padding:"0.75rem",border:"1px solid #e2e8f0",borderRadius:"8px",fontSize:"0.9rem"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.875rem",fontWeight:"600"},children:"Valor *"}),e.jsx("input",{type:"number",step:"0.01",min:"0.01",value:a.amount,onChange:t=>x({...a,amount:t.target.value}),required:!0,style:{width:"100%",padding:"0.75rem",border:"1px solid #e2e8f0",borderRadius:"8px",fontSize:"0.9rem"}})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem",marginBottom:"1rem"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.875rem",fontWeight:"600"},children:"Valor Pago"}),e.jsx("input",{type:"number",step:"0.01",min:"0",value:a.paid_amount,onChange:t=>x({...a,paid_amount:t.target.value}),style:{width:"100%",padding:"0.75rem",border:"1px solid #e2e8f0",borderRadius:"8px",fontSize:"0.9rem"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.875rem",fontWeight:"600"},children:"Data de Pagamento"}),e.jsx("input",{type:"date",value:a.payment_date,onChange:t=>x({...a,payment_date:t.target.value}),style:{width:"100%",padding:"0.75rem",border:"1px solid #e2e8f0",borderRadius:"8px",fontSize:"0.9rem"}})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem",marginBottom:"1rem"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.875rem",fontWeight:"600"},children:"Categoria"}),e.jsx("input",{type:"text",value:a.category,onChange:t=>x({...a,category:t.target.value}),style:{width:"100%",padding:"0.75rem",border:"1px solid #e2e8f0",borderRadius:"8px",fontSize:"0.9rem"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.875rem",fontWeight:"600"},children:"Método de Pagamento"}),e.jsxs("select",{value:a.payment_method,onChange:t=>x({...a,payment_method:t.target.value}),style:{width:"100%",padding:"0.75rem",border:"1px solid #e2e8f0",borderRadius:"8px",fontSize:"0.9rem"},children:[e.jsx("option",{value:"",children:"Selecione"}),e.jsx("option",{value:"cash",children:"Dinheiro"}),e.jsx("option",{value:"credit_card",children:"Cartão de Crédito"}),e.jsx("option",{value:"debit_card",children:"Cartão de Débito"}),e.jsx("option",{value:"pix",children:"PIX"}),e.jsx("option",{value:"bank_transfer",children:"Transferência Bancária"})]})]})]}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.875rem",fontWeight:"600"},children:"Observações"}),e.jsx("textarea",{value:a.notes,onChange:t=>x({...a,notes:t.target.value}),rows:3,style:{width:"100%",padding:"0.75rem",border:"1px solid #e2e8f0",borderRadius:"8px",fontSize:"0.9rem",resize:"vertical"}})]}),e.jsxs("div",{style:{display:"flex",gap:"1rem",justifyContent:"flex-end"},children:[e.jsx("button",{type:"button",onClick:()=>{C(!1),W()},style:{padding:"0.75rem 1.5rem",backgroundColor:"#f1f5f9",color:"#64748b",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:"600"},children:"Cancelar"}),e.jsx("button",{type:"submit",style:{padding:"0.75rem 1.5rem",backgroundColor:"#f97316",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:"600"},children:R?"Atualizar":"Criar"})]})]})]})}),xe&&e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},onClick:()=>{S(!1),D()},children:e.jsxs("div",{style:{backgroundColor:"white",borderRadius:"12px",padding:"2rem",width:"90%",maxWidth:"600px",maxHeight:"90vh",overflowY:"auto"},onClick:t=>t.stopPropagation(),children:[e.jsx("h2",{style:{marginBottom:"1.5rem",fontSize:"1.5rem",fontWeight:"bold"},children:_?"Editar Conta a Receber":"Nova Conta a Receber"}),e.jsxs("form",{onSubmit:ve,children:[e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.875rem",fontWeight:"600"},children:"Cliente *"}),e.jsxs("select",{value:o.client_id,onChange:t=>g({...o,client_id:t.target.value}),required:!0,style:{width:"100%",padding:"0.75rem",border:"1px solid #e2e8f0",borderRadius:"8px",fontSize:"0.9rem"},children:[e.jsx("option",{value:"",children:"Selecione um cliente"}),ue.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.875rem",fontWeight:"600"},children:"Descrição *"}),e.jsx("input",{type:"text",value:o.description,onChange:t=>g({...o,description:t.target.value}),required:!0,style:{width:"100%",padding:"0.75rem",border:"1px solid #e2e8f0",borderRadius:"8px",fontSize:"0.9rem"}})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem",marginBottom:"1rem"},children:[!b&&e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.875rem",fontWeight:"600"},children:"Data de Vencimento *"}),e.jsx("input",{type:"date",value:o.due_date,onChange:t=>g({...o,due_date:t.target.value}),required:!b,style:{width:"100%",padding:"0.75rem",border:"1px solid #e2e8f0",borderRadius:"8px",fontSize:"0.9rem"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.875rem",fontWeight:"600"},children:"Valor Total *"}),e.jsx("input",{type:"number",step:"0.01",min:"0.01",value:o.amount,onChange:t=>g({...o,amount:t.target.value}),required:!0,style:{width:"100%",padding:"0.75rem",border:"1px solid #e2e8f0",borderRadius:"8px",fontSize:"0.9rem"}})]})]}),e.jsx("div",{style:{marginBottom:"1rem"},children:e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",fontSize:"0.875rem",fontWeight:"600",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:b,onChange:t=>{X(t.target.checked),t.target.checked||z([])},disabled:!!_,style:{cursor:"pointer"}}),"Dividir em parcelas"]})}),b&&!_&&e.jsxs("div",{style:{marginBottom:"1.5rem",padding:"1rem",backgroundColor:"#f8fafc",borderRadius:"8px",border:"1px solid #e2e8f0"},children:[e.jsxs("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"1rem",alignItems:"flex-end"},children:[e.jsxs("div",{style:{flex:1},children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.875rem",fontWeight:"600"},children:"Número de Parcelas"}),e.jsx("input",{type:"number",min:"2",max:"24",value:Y,onChange:t=>G(parseInt(t.target.value)||2),style:{width:"100%",padding:"0.75rem",border:"1px solid #e2e8f0",borderRadius:"8px",fontSize:"0.9rem"}})]}),e.jsxs("div",{style:{flex:1},children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.875rem",fontWeight:"600"},children:"Data da Primeira Parcela"}),e.jsx("input",{type:"date",value:o.due_date,onChange:t=>g({...o,due_date:t.target.value}),style:{width:"100%",padding:"0.75rem",border:"1px solid #e2e8f0",borderRadius:"8px",fontSize:"0.9rem"}})]}),e.jsx("button",{type:"button",onClick:Ce,disabled:!o.amount||parseFloat(o.amount)<=0||!o.due_date,style:{padding:"0.75rem 1rem",backgroundColor:"#3b82f6",color:"white",border:"none",borderRadius:"8px",cursor:!o.amount||parseFloat(o.amount)<=0||!o.due_date?"not-allowed":"pointer",fontWeight:"600",opacity:!o.amount||parseFloat(o.amount)<=0||!o.due_date?.5:1},children:"Gerar Parcelas"})]}),c.length>0&&e.jsxs("div",{children:[e.jsxs("div",{style:{fontSize:"0.875rem",fontWeight:"600",marginBottom:"0.75rem"},children:["Parcelas (",c.length,")"]}),e.jsx("div",{style:{maxHeight:"300px",overflowY:"auto"},children:c.map((t,r)=>e.jsx("div",{style:{marginBottom:"0.75rem",padding:"0.75rem",backgroundColor:"white",borderRadius:"6px",border:"1px solid #e2e8f0"},children:e.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[e.jsxs("div",{style:{minWidth:"40px",fontSize:"0.875rem",fontWeight:"600",color:"#64748b"},children:[t.installment_number,"ª"]}),e.jsxs("div",{style:{flex:1},children:[e.jsx("label",{style:{display:"block",marginBottom:"0.25rem",fontSize:"0.75rem",color:"#64748b"},children:"Vencimento"}),e.jsx("input",{type:"date",value:t.due_date,onChange:n=>U(r,"due_date",n.target.value),style:{width:"100%",padding:"0.5rem",border:"1px solid #e2e8f0",borderRadius:"6px",fontSize:"0.875rem"}})]}),e.jsxs("div",{style:{flex:1},children:[e.jsx("label",{style:{display:"block",marginBottom:"0.25rem",fontSize:"0.75rem",color:"#64748b"},children:"Valor"}),e.jsx("input",{type:"number",step:"0.01",min:"0",value:t.amount,onChange:n=>U(r,"amount",parseFloat(n.target.value)||0),style:{width:"100%",padding:"0.5rem",border:"1px solid #e2e8f0",borderRadius:"6px",fontSize:"0.875rem"}})]}),c.length>1&&e.jsx("button",{type:"button",onClick:()=>{const n=c.filter((i,p)=>p!==r);n.forEach((i,p)=>{i.installment_number=p+1}),z(n)},style:{padding:"0.5rem",backgroundColor:"#fee2e2",border:"none",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center"},title:"Remover parcela",children:e.jsx(Be,{size:16,color:"#ef4444"})})]})},r))}),o.amount&&c.length>0&&e.jsx("div",{style:{marginTop:"0.75rem",padding:"0.75rem",backgroundColor:"#f0fdf4",borderRadius:"6px",border:"1px solid #86efac"},children:e.jsxs("div",{style:{fontSize:"0.875rem",fontWeight:"600",color:"#10b981"},children:["Total: ",m(c.reduce((t,r)=>t+parseFloat(r.amount.toString()),0)),Math.abs(c.reduce((t,r)=>t+parseFloat(r.amount.toString()),0)-parseFloat(o.amount))>.01&&e.jsxs("span",{style:{color:"#ef4444",marginLeft:"0.5rem"},children:["(Diferença: ",m(c.reduce((t,r)=>t+parseFloat(r.amount.toString()),0)-parseFloat(o.amount)),")"]})]})})]})]}),!b&&e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem",marginBottom:"1rem"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.875rem",fontWeight:"600"},children:"Valor Recebido"}),e.jsx("input",{type:"number",step:"0.01",min:"0",value:o.paid_amount,onChange:t=>g({...o,paid_amount:t.target.value}),style:{width:"100%",padding:"0.75rem",border:"1px solid #e2e8f0",borderRadius:"8px",fontSize:"0.9rem"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.875rem",fontWeight:"600"},children:"Data de Recebimento"}),e.jsx("input",{type:"date",value:o.payment_date,onChange:t=>g({...o,payment_date:t.target.value}),style:{width:"100%",padding:"0.75rem",border:"1px solid #e2e8f0",borderRadius:"8px",fontSize:"0.9rem"}})]})]}),!b&&e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.875rem",fontWeight:"600"},children:"Método de Pagamento"}),e.jsxs("select",{value:o.payment_method,onChange:t=>g({...o,payment_method:t.target.value}),style:{width:"100%",padding:"0.75rem",border:"1px solid #e2e8f0",borderRadius:"8px",fontSize:"0.9rem"},children:[e.jsx("option",{value:"",children:"Selecione"}),e.jsx("option",{value:"cash",children:"Dinheiro"}),e.jsx("option",{value:"credit_card",children:"Cartão de Crédito"}),e.jsx("option",{value:"debit_card",children:"Cartão de Débito"}),e.jsx("option",{value:"pix",children:"PIX"}),e.jsx("option",{value:"bank_transfer",children:"Transferência Bancária"})]})]}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.875rem",fontWeight:"600"},children:"Observações"}),e.jsx("textarea",{value:o.notes,onChange:t=>g({...o,notes:t.target.value}),rows:3,style:{width:"100%",padding:"0.75rem",border:"1px solid #e2e8f0",borderRadius:"8px",fontSize:"0.9rem",resize:"vertical"}})]}),e.jsxs("div",{style:{display:"flex",gap:"1rem",justifyContent:"flex-end"},children:[e.jsx("button",{type:"button",onClick:()=>{S(!1),D()},style:{padding:"0.75rem 1.5rem",backgroundColor:"#f1f5f9",color:"#64748b",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:"600"},children:"Cancelar"}),e.jsx("button",{type:"submit",style:{padding:"0.75rem 1.5rem",backgroundColor:"#f97316",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:"600"},children:_?"Atualizar":"Criar"})]})]})]})})]})};export{Ae as default};
