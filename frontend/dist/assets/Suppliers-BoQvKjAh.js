import{u as R,a as h,j as e}from"./index-DNHKrThd.js";import{r as i}from"./react-vendor-BpgKpUzx.js";import{z as d,S as W,I as E,g as A,T as I,J as F,K as T,O as N,Q as P}from"./ui-vendor-yLLZ9URH.js";import{u as $}from"./usePermission-Kf1Dlq5z.js";import"./pdf-vendor-BOaogWDS.js";const H=()=>{const{hasPermission:x,loading:p}=$("suppliers","view"),{user:n}=R(),[u,j]=i.useState([]),[v,f]=i.useState(!0),[l,S]=i.useState(""),[z,a]=i.useState(!1),[c,y]=i.useState(null),[t,o]=i.useState({name:"",cnpj:"",contact_name:"",phone:"",email:"",address_street:"",address_number:"",address_complement:"",address_neighborhood:"",address_city:"",address_state:"",address_zipcode:"",notes:"",active:!0});i.useEffect(()=>{p||((n==null?void 0:n.profile)==="admin"||x?g():f(!1))},[l,x,p,n]);const g=async()=>{try{f(!0);const r=l?{search:l}:{},s=await h.get("/suppliers",{params:r});j(s.data)}catch(r){d.error("Erro ao carregar fornecedores"),console.error(r)}finally{f(!1)}},C=async r=>{var s,b;r.preventDefault();try{c?(await h.put(`/suppliers/${c.id}`,t),d.success("Fornecedor atualizado com sucesso!")):(await h.post("/suppliers",t),d.success("Fornecedor criado com sucesso!")),a(!1),m(),g()}catch(B){d.error(((b=(s=B.response)==null?void 0:s.data)==null?void 0:b.error)||"Erro ao salvar fornecedor")}},_=r=>{y(r),o({name:r.name,cnpj:r.cnpj||"",contact_name:r.contact_name||"",phone:r.phone||"",email:r.email||"",address_street:"",address_number:"",address_complement:"",address_neighborhood:"",address_city:r.address_city||"",address_state:r.address_state||"",address_zipcode:"",notes:"",active:r.active}),a(!0)},w=async r=>{if(confirm("Tem certeza que deseja excluir este fornecedor?"))try{await h.delete(`/suppliers/${r}`),d.success("Fornecedor excluído com sucesso!"),g()}catch{d.error("Erro ao excluir fornecedor")}},m=()=>{o({name:"",cnpj:"",contact_name:"",phone:"",email:"",address_street:"",address_number:"",address_complement:"",address_neighborhood:"",address_city:"",address_state:"",address_zipcode:"",notes:"",active:!0}),y(null)},k=r=>r?r.replace(/(\d{2})(\d{3})(\d{3})(\d{4})(\d{2})/,"$1.$2.$3/$4-$5"):"-";return p?e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"60vh"},children:e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{style:{border:"4px solid #f3f4f6",borderTop:"4px solid #f97316",borderRadius:"50%",width:"48px",height:"48px",animation:"spin 1s linear infinite",margin:"0 auto 1rem"}}),e.jsx("p",{style:{color:"#64748b"},children:"Verificando permissões..."})]})}):(n==null?void 0:n.profile)!=="admin"&&!x?e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"60vh",flexDirection:"column",gap:"1rem",padding:"2rem"},children:e.jsxs("div",{style:{backgroundColor:"#fef2f2",border:"1px solid #fecaca",borderRadius:"8px",padding:"2rem",maxWidth:"500px",textAlign:"center"},children:[e.jsx(W,{size:48,color:"#dc2626",style:{margin:"0 auto 1rem"}}),e.jsx("h2",{style:{color:"#dc2626",marginBottom:"0.5rem",fontSize:"1.5rem"},children:"Acesso Negado"}),e.jsx("p",{style:{color:"#991b1b",marginBottom:"1rem",fontSize:"1rem"},children:"Você não tem permissão para acessar Fornecedores."}),e.jsx("p",{style:{color:"#64748b",fontSize:"0.875rem"},children:"Entre em contato com o administrador para solicitar acesso."})]})}):e.jsxs("div",{children:[e.jsxs("div",{style:{marginBottom:"2rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsx("h1",{style:{fontSize:"1.875rem",fontWeight:"bold",color:"#1e293b",marginBottom:"0.5rem"},children:"Fornecedores"}),e.jsx("p",{style:{color:"#64748b",fontSize:"0.9rem"},children:"Gerencie o cadastro de fornecedores"})]}),e.jsxs("button",{onClick:()=>{m(),a(!0)},style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.75rem 1.5rem",backgroundColor:"#f97316",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:"600"},children:[e.jsx(E,{size:20}),"Novo Fornecedor"]})]}),e.jsx("div",{style:{marginBottom:"1.5rem"},children:e.jsxs("div",{style:{position:"relative",maxWidth:"400px"},children:[e.jsx(A,{size:20,style:{position:"absolute",left:"12px",top:"50%",transform:"translateY(-50%)",color:"#64748b"}}),e.jsx("input",{type:"text",placeholder:"Buscar por nome, CNPJ, contato, email ou telefone...",value:l,onChange:r=>S(r.target.value),style:{width:"100%",padding:"0.75rem 1rem 0.75rem 2.5rem",border:"1px solid #e2e8f0",borderRadius:"8px",fontSize:"0.9rem",outline:"none"}})]})}),e.jsx("div",{style:{backgroundColor:"white",borderRadius:"12px",boxShadow:"0 1px 3px 0 rgb(0 0 0 / 0.1)",overflow:"hidden"},children:v?e.jsx("div",{style:{padding:"3rem",textAlign:"center",color:"#64748b"},children:"Carregando..."}):u.length===0?e.jsx("div",{style:{padding:"3rem",textAlign:"center",color:"#64748b"},children:"Nenhum fornecedor encontrado"}):e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{backgroundColor:"#f8fafc",borderBottom:"1px solid #e2e8f0"},children:[e.jsx("th",{style:{padding:"1rem",textAlign:"left",fontSize:"0.875rem",fontWeight:"600",color:"#64748b"},children:"Fornecedor"}),e.jsx("th",{style:{padding:"1rem",textAlign:"left",fontSize:"0.875rem",fontWeight:"600",color:"#64748b"},children:"CNPJ"}),e.jsx("th",{style:{padding:"1rem",textAlign:"left",fontSize:"0.875rem",fontWeight:"600",color:"#64748b"},children:"Contato"}),e.jsx("th",{style:{padding:"1rem",textAlign:"left",fontSize:"0.875rem",fontWeight:"600",color:"#64748b"},children:"Localização"}),e.jsx("th",{style:{padding:"1rem",textAlign:"center",fontSize:"0.875rem",fontWeight:"600",color:"#64748b"},children:"Ações"})]})}),e.jsx("tbody",{children:u.map(r=>e.jsxs("tr",{style:{borderBottom:"1px solid #e2e8f0",transition:"background-color 0.2s"},onMouseEnter:s=>{s.currentTarget.style.backgroundColor="#f8fafc"},onMouseLeave:s=>{s.currentTarget.style.backgroundColor="white"},children:[e.jsx("td",{style:{padding:"1rem"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"50%",backgroundColor:"#3b82f6",color:"white",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(I,{size:20})}),e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:"600",color:"#1e293b"},children:r.name}),r.contact_name&&e.jsxs("div",{style:{fontSize:"0.75rem",color:"#64748b"},children:["Contato: ",r.contact_name]})]})]})}),e.jsx("td",{style:{padding:"1rem",color:"#64748b",fontFamily:"monospace",fontSize:"0.875rem"},children:k(r.cnpj)}),e.jsx("td",{style:{padding:"1rem"},children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem"},children:[r.phone&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",fontSize:"0.875rem"},children:[e.jsx(F,{size:14,color:"#64748b"}),e.jsx("span",{style:{color:"#64748b"},children:r.phone})]}),r.email&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",fontSize:"0.875rem"},children:[e.jsx(T,{size:14,color:"#64748b"}),e.jsx("span",{style:{color:"#64748b"},children:r.email})]})]})}),e.jsx("td",{style:{padding:"1rem",color:"#64748b",fontSize:"0.875rem"},children:r.address_city&&r.address_state?`${r.address_city}/${r.address_state}`:"-"}),e.jsx("td",{style:{padding:"1rem"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:"0.5rem"},children:[e.jsx("button",{onClick:()=>_(r),style:{padding:"0.5rem",backgroundColor:"#f1f5f9",border:"none",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},title:"Editar",children:e.jsx(N,{size:16,color:"#64748b"})}),e.jsx("button",{onClick:()=>w(r.id),style:{padding:"0.5rem",backgroundColor:"#fee2e2",border:"none",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},title:"Excluir",children:e.jsx(P,{size:16,color:"#ef4444"})})]})})]},r.id))})]})}),z&&e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},onClick:()=>{a(!1),m()},children:e.jsxs("div",{style:{backgroundColor:"white",borderRadius:"12px",padding:"2rem",width:"90%",maxWidth:"600px",maxHeight:"90vh",overflowY:"auto"},onClick:r=>r.stopPropagation(),children:[e.jsx("h2",{style:{marginBottom:"1.5rem",fontSize:"1.5rem",fontWeight:"bold"},children:c?"Editar Fornecedor":"Novo Fornecedor"}),e.jsxs("form",{onSubmit:C,children:[e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.875rem",fontWeight:"600"},children:"Razão Social / Nome *"}),e.jsx("input",{type:"text",value:t.name,onChange:r=>o({...t,name:r.target.value}),required:!0,style:{width:"100%",padding:"0.75rem",border:"1px solid #e2e8f0",borderRadius:"8px",fontSize:"0.9rem"}})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem",marginBottom:"1rem"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.875rem",fontWeight:"600"},children:"CNPJ"}),e.jsx("input",{type:"text",value:t.cnpj,onChange:r=>o({...t,cnpj:r.target.value}),placeholder:"00.000.000/0000-00",style:{width:"100%",padding:"0.75rem",border:"1px solid #e2e8f0",borderRadius:"8px",fontSize:"0.9rem"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.875rem",fontWeight:"600"},children:"Nome do Contato"}),e.jsx("input",{type:"text",value:t.contact_name,onChange:r=>o({...t,contact_name:r.target.value}),style:{width:"100%",padding:"0.75rem",border:"1px solid #e2e8f0",borderRadius:"8px",fontSize:"0.9rem"}})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem",marginBottom:"1rem"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.875rem",fontWeight:"600"},children:"Telefone"}),e.jsx("input",{type:"text",value:t.phone,onChange:r=>o({...t,phone:r.target.value}),placeholder:"(00) 00000-0000",style:{width:"100%",padding:"0.75rem",border:"1px solid #e2e8f0",borderRadius:"8px",fontSize:"0.9rem"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.875rem",fontWeight:"600"},children:"E-mail"}),e.jsx("input",{type:"email",value:t.email,onChange:r=>o({...t,email:r.target.value}),style:{width:"100%",padding:"0.75rem",border:"1px solid #e2e8f0",borderRadius:"8px",fontSize:"0.9rem"}})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr",gap:"1rem",marginBottom:"1rem"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.875rem",fontWeight:"600"},children:"Cidade"}),e.jsx("input",{type:"text",value:t.address_city,onChange:r=>o({...t,address_city:r.target.value}),style:{width:"100%",padding:"0.75rem",border:"1px solid #e2e8f0",borderRadius:"8px",fontSize:"0.9rem"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.875rem",fontWeight:"600"},children:"Estado"}),e.jsx("input",{type:"text",value:t.address_state,onChange:r=>o({...t,address_state:r.target.value.toUpperCase()}),maxLength:2,placeholder:"RS",style:{width:"100%",padding:"0.75rem",border:"1px solid #e2e8f0",borderRadius:"8px",fontSize:"0.9rem"}})]})]}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.875rem",fontWeight:"600"},children:"Observações"}),e.jsx("textarea",{value:t.notes,onChange:r=>o({...t,notes:r.target.value}),rows:3,style:{width:"100%",padding:"0.75rem",border:"1px solid #e2e8f0",borderRadius:"8px",fontSize:"0.9rem",resize:"vertical"}})]}),e.jsxs("div",{style:{display:"flex",gap:"1rem",justifyContent:"flex-end"},children:[e.jsx("button",{type:"button",onClick:()=>{a(!1),m()},style:{padding:"0.75rem 1.5rem",backgroundColor:"#f1f5f9",color:"#64748b",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:"600"},children:"Cancelar"}),e.jsx("button",{type:"submit",style:{padding:"0.75rem 1.5rem",backgroundColor:"#f97316",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:"600"},children:c?"Atualizar":"Criar"})]})]})]})})]})};export{H as default};
