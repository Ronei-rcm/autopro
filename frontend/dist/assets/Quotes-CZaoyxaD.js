import{_ as st}from"./pdf-vendor-BOaogWDS.js";import{a as g,j as e,u as lt}from"./index-DNHKrThd.js";import{u as at,r as a,h as dt}from"./react-vendor-BpgKpUzx.js";import{z as m,X as Se,D as ct,h as Oe,a as mt,s as pt,F as ut,I as Pe,g as gt,N as ft,$ as Ee,O as ht,u as xt,A as Me,Q as bt,P as yt,W as jt}from"./ui-vendor-yLLZ9URH.js";import{S as vt}from"./SkeletonLoader-DMsGFzU7.js";import{P as St}from"./Pagination-MtMwbbp0.js";import{C as $e}from"./ConfirmDialog-DmvZqo8B.js";const Ct=({quoteId:K,quoteNumber:pe,clientName:F,vehicleBrand:I,vehicleModel:ue,vehiclePlate:Z,total:ge,onClose:$,onSuccess:ee})=>{const H=at(),[G,U]=a.useState([]),[f,te]=a.useState(null),[C,b]=a.useState(""),[R,y]=a.useState(""),[re,Y]=a.useState(""),[k,L]=a.useState(!1),[oe,A]=a.useState(!0);a.useEffect(()=>{fe();const c=new Date;c.setHours(c.getHours()+1,0,0,0);const h=c.toISOString().slice(0,16);b(h);const B=new Date(c.getTime()+2*60*60*1e3).toISOString().slice(0,16);y(B)},[]);const fe=async()=>{try{A(!0);const c=await g.get("/users/mechanics");U(c.data)}catch(c){console.error("Erro ao carregar mecânicos:",c),m.error("Erro ao carregar lista de mecânicos")}finally{A(!1)}},P=async()=>{var B,_;if(!f){m.error("Selecione um mecânico");return}if(!C||!R){m.error("Preencha data e hora de início e término");return}const c=new Date(C),h=new Date(R);if(h<=c){m.error("Data/hora de término deve ser posterior à data/hora de início");return}if(c<new Date){m.error("Data/hora de início não pode ser no passado");return}try{L(!0);const z=await g.post(`/quotes/${K}/approve-and-schedule`,{mechanic_id:f,start_time:c.toISOString(),end_time:h.toISOString(),notes:re||null});console.log("Resposta da aprovação:",z.data),z.data.appointment?(m.success(`Orçamento aprovado e agendamento criado com sucesso! ID: ${z.data.appointment.id}`,{duration:5e3}),console.log("Agendamento criado:",z.data.appointment)):(m.success("Orçamento aprovado com sucesso!",{duration:5e3}),console.warn("Aviso: Agendamento não retornado na resposta")),ee(),$(),setTimeout(()=>{H("/agendamentos")},1e3)}catch(z){console.error("Erro ao aprovar orçamento:",z),m.error(((_=(B=z.response)==null?void 0:B.data)==null?void 0:_.error)||"Erro ao aprovar orçamento e criar agendamento")}finally{L(!1)}};return G.find(c=>c.id===f),e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},onClick:$,children:e.jsxs("div",{style:{backgroundColor:"white",borderRadius:"12px",padding:"1.5rem",width:"90%",maxWidth:"600px",maxHeight:"90vh",overflow:"auto",boxShadow:"0 20px 25px -5px rgba(0, 0, 0, 0.1)"},onClick:c=>c.stopPropagation(),children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1.5rem"},children:[e.jsxs("div",{children:[e.jsxs("h2",{style:{fontSize:"1.25rem",fontWeight:"600",color:"#1e293b",margin:0},children:["Aprovar Orçamento #",pe]}),e.jsxs("p",{style:{fontSize:"0.875rem",color:"#64748b",margin:"0.25rem 0 0 0"},children:[F," - ",I," ",ue," ",Z?`(${Z})`:""]})]}),e.jsx("button",{onClick:$,style:{padding:"0.5rem",backgroundColor:"transparent",border:"none",borderRadius:"8px",cursor:"pointer",color:"#64748b",display:"flex",alignItems:"center",justifyContent:"center"},onMouseEnter:c=>{c.currentTarget.style.backgroundColor="#f1f5f9"},onMouseLeave:c=>{c.currentTarget.style.backgroundColor="transparent"},children:e.jsx(Se,{size:20})})]}),e.jsxs("div",{style:{padding:"1rem",backgroundColor:"#f8fafc",borderRadius:"8px",marginBottom:"1.5rem",display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx(ct,{size:20,color:"#f97316"}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.875rem",color:"#64748b"},children:"Valor Total do Orçamento"}),e.jsx("div",{style:{fontSize:"1.5rem",fontWeight:"600",color:"#1e293b"},children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(ge)})]})]}),e.jsxs("div",{style:{marginBottom:"1.5rem"},children:[e.jsxs("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"500",color:"#374151",marginBottom:"0.75rem"},children:[e.jsx(Oe,{size:16,style:{display:"inline",marginRight:"0.5rem",verticalAlign:"middle"}}),"Selecione o Mecânico:"]}),oe?e.jsx("div",{style:{padding:"2rem",textAlign:"center",color:"#64748b"},children:"Carregando mecânicos..."}):G.length===0?e.jsx("div",{style:{padding:"2rem",textAlign:"center",color:"#64748b"},children:"Nenhum mecânico disponível"}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem",maxHeight:"200px",overflowY:"auto"},children:G.map(c=>e.jsxs("button",{onClick:()=>te(c.id),style:{padding:"1rem",backgroundColor:f===c.id?"#e0e7ff":"#f8fafc",border:`2px solid ${f===c.id?"#6366f1":"#e2e8f0"}`,borderRadius:"8px",cursor:"pointer",display:"flex",alignItems:"center",gap:"0.75rem",transition:"all 0.2s",textAlign:"left"},onMouseEnter:h=>{f!==c.id&&(h.currentTarget.style.backgroundColor="#f1f5f9")},onMouseLeave:h=>{f!==c.id&&(h.currentTarget.style.backgroundColor="#f8fafc")},children:[e.jsx("div",{style:{width:"40px",height:"40px",borderRadius:"50%",backgroundColor:f===c.id?"#6366f1":"#cbd5e1",display:"flex",alignItems:"center",justifyContent:"center",color:"white",flexShrink:0},children:e.jsx(Oe,{size:20})}),e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{fontWeight:f===c.id?"600":"500",color:"#1e293b",marginBottom:"0.25rem"},children:c.name}),e.jsx("div",{style:{fontSize:"0.75rem",color:"#64748b"},children:c.email})]})]},c.id))})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem",marginBottom:"1.5rem"},children:[e.jsxs("div",{children:[e.jsxs("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"500",color:"#374151",marginBottom:"0.5rem"},children:[e.jsx(mt,{size:16,style:{display:"inline",marginRight:"0.5rem",verticalAlign:"middle"}}),"Data/Hora de Início:"]}),e.jsx("input",{type:"datetime-local",value:C,onChange:c=>b(c.target.value),style:{width:"100%",padding:"0.75rem",border:"1px solid #e2e8f0",borderRadius:"8px",fontSize:"0.875rem"}})]}),e.jsxs("div",{children:[e.jsxs("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"500",color:"#374151",marginBottom:"0.5rem"},children:[e.jsx(pt,{size:16,style:{display:"inline",marginRight:"0.5rem",verticalAlign:"middle"}}),"Data/Hora de Término:"]}),e.jsx("input",{type:"datetime-local",value:R,onChange:c=>y(c.target.value),style:{width:"100%",padding:"0.75rem",border:"1px solid #e2e8f0",borderRadius:"8px",fontSize:"0.875rem"}})]})]}),e.jsxs("div",{style:{marginBottom:"1.5rem"},children:[e.jsxs("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"500",color:"#374151",marginBottom:"0.5rem"},children:[e.jsx(ut,{size:16,style:{display:"inline",marginRight:"0.5rem",verticalAlign:"middle"}}),"Observações (opcional):"]}),e.jsx("textarea",{value:re,onChange:c=>Y(c.target.value),placeholder:"Observações sobre o agendamento...",rows:3,style:{width:"100%",padding:"0.75rem",border:"1px solid #e2e8f0",borderRadius:"8px",fontSize:"0.875rem",fontFamily:"inherit",resize:"vertical"}})]}),e.jsxs("div",{style:{display:"flex",gap:"0.75rem",justifyContent:"flex-end"},children:[e.jsx("button",{onClick:$,disabled:k,style:{padding:"0.75rem 1.5rem",backgroundColor:"#f1f5f9",color:"#64748b",border:"none",borderRadius:"8px",cursor:k?"not-allowed":"pointer",fontWeight:"600",opacity:k?.5:1},children:"Cancelar"}),e.jsx("button",{onClick:P,disabled:k||!f||!C||!R,style:{padding:"0.75rem 1.5rem",backgroundColor:f&&C&&R?"#f97316":"#cbd5e1",color:"white",border:"none",borderRadius:"8px",cursor:k||!f||!C||!R?"not-allowed":"pointer",fontWeight:"600",opacity:k?.5:1,display:"flex",alignItems:"center",gap:"0.5rem"},children:k?"Processando...":"Aprovar e Agendar"})]})]})})},At=()=>{var Re,ke,Ae,Be;const[K,pe]=dt(),{user:F}=lt(),[I,ue]=a.useState([]),[Z,ge]=a.useState([]),[$,ee]=a.useState([]),[H,G]=a.useState([]),[U,f]=a.useState([]),[te,C]=a.useState(!0),[b,R]=a.useState(""),[y,re]=a.useState(""),[Y,k]=a.useState({}),[L,oe]=a.useState(1),[A]=a.useState(10),[fe,P]=a.useState(!1),[c,h]=a.useState(!1),[B,_]=a.useState(!1),[z,ie]=a.useState(!1),[D,ne]=a.useState(null),[E,N]=a.useState(null),[w,Ce]=a.useState(null),[Le,he]=a.useState(null),[T,X]=a.useState([]),[Q,se]=a.useState({isOpen:!1,quote:null}),[le,ae]=a.useState({isOpen:!1,quote:null}),[p,O]=a.useState({client_id:"",vehicle_id:"",status:"open",discount:"0",valid_until:"",notes:""}),[d,v]=a.useState({item_type:"product",product_id:"",labor_id:"",description:"",quantity:"1",unit_price:"0"});a.useEffect(()=>{q(),Ne(),Qe(),qe()},[b,y,Y]),a.useEffect(()=>{const t=K.get("approve");if(t&&I.length>0){const o=I.find(r=>r.id===parseInt(t));o&&o.status==="open"&&(ne(o),ie(!0),pe({}))}},[K,I]),a.useEffect(()=>{oe(1)},[Y,b,y]),a.useEffect(()=>{B&&E&&ze(E)},[B,E]);const q=async()=>{try{C(!0);const t={};b&&(t.search=b),y&&(t.status=y),Object.entries(Y).forEach(([r,l])=>{l&&(t[r]=l)});const o=await g.get("/quotes",{params:t});ue(o.data)}catch(t){m.error("Erro ao carregar orçamentos"),console.error(t)}finally{C(!1)}},Ne=async()=>{try{const t=await g.get("/clients");ge(t.data)}catch(t){console.error("Erro ao carregar clientes:",t)}},_e=async t=>{try{const o=t?{client_id:t}:{},r=await g.get("/vehicles",{params:o});ee(r.data)}catch(o){console.error("Erro ao carregar veículos:",o)}},Qe=async()=>{try{const t=await g.get("/products");G(t.data)}catch(t){console.error("Erro ao carregar produtos:",t)}},qe=async()=>{try{const t=await g.get("/labor-types",{params:{active:"true"}});f(t.data)}catch(t){console.error("Erro ao carregar tipos de mão de obra:",t)}},ze=async t=>{try{const o=await g.get(`/quotes/${t}`);X(o.data.items||[]),he(o.data)}catch(o){console.error("Erro ao carregar itens:",o)}},de=()=>{O({client_id:"",vehicle_id:"",status:"open",discount:"0",valid_until:"",notes:""}),X([]),he(null),Ce(null),v({item_type:"product",product_id:"",labor_id:"",description:"",quantity:"1",unit_price:"0"})},xe=()=>{v({item_type:"product",product_id:"",labor_id:"",description:"",quantity:"1",unit_price:"0"})},Ve=async t=>{var o,r;if(t.preventDefault(),!p.client_id||!p.vehicle_id){m.error("Cliente e veículo são obrigatórios");return}if(T.length===0){m.error("Orçamento deve ter pelo menos um item");return}try{const l=T.map(i=>({product_id:i.product_id||null,labor_id:i.labor_id||null,description:i.description,quantity:i.quantity,unit_price:i.unit_price,total_price:i.total_price,item_type:i.item_type})),S={client_id:parseInt(p.client_id),vehicle_id:parseInt(p.vehicle_id),status:p.status,discount:parseFloat(p.discount)||0,valid_until:p.valid_until||null,notes:p.notes,items:l};w?(await g.put(`/quotes/${w.id}`,S),m.success("Orçamento atualizado com sucesso!")):(await g.post("/quotes",S),m.success("Orçamento criado com sucesso!")),P(!1),de(),q()}catch(l){m.error(((r=(o=l.response)==null?void 0:o.data)==null?void 0:r.error)||"Erro ao salvar orçamento")}},He=t=>{var i,n;if(t.preventDefault(),!d.description.trim()){m.error("Descrição é obrigatória");return}const o=parseFloat(d.quantity),r=parseFloat(d.unit_price);if(o<=0){m.error("Quantidade deve ser maior que zero");return}if(r<0){m.error("Preço unitário deve ser maior ou igual a zero");return}const l=o*r,S={id:Date.now(),product_id:d.item_type==="product"&&d.product_id?parseInt(d.product_id):void 0,labor_id:d.item_type==="labor"&&d.labor_id?parseInt(d.labor_id):void 0,product_name:d.item_type==="product"&&d.product_id?(i=H.find(j=>j.id===parseInt(d.product_id)))==null?void 0:i.name:void 0,labor_name:d.item_type==="labor"&&d.labor_id?(n=U.find(j=>j.id===parseInt(d.labor_id)))==null?void 0:n.name:void 0,description:d.description,quantity:o,unit_price:r,total_price:l,item_type:d.item_type};X([...T,S]),xe(),h(!1)},Ge=t=>{X(T.filter(o=>o.id!==t))},Ue=async t=>{Ce(t),O({client_id:t.client_id.toString(),vehicle_id:t.vehicle_id.toString(),status:t.status,discount:t.discount.toString(),valid_until:t.valid_until?t.valid_until.split("T")[0]:"",notes:t.notes||""}),await _e(t.client_id);const o=await g.get(`/quotes/${t.id}`);X(o.data.items||[]),he(o.data),P(!0)},Ye=t=>{se({isOpen:!0,quote:t})},Xe=async()=>{var t,o;if(Q.quote)try{await g.delete(`/quotes/${Q.quote.id}`),m.success("Orçamento excluído com sucesso!"),se({isOpen:!1,quote:null}),q()}catch(r){const l=((o=(t=r.response)==null?void 0:t.data)==null?void 0:o.error)||"Erro ao excluir orçamento";m.error(l),console.error("Erro ao excluir orçamento:",r),se({isOpen:!1,quote:null})}},we=t=>{ae({isOpen:!0,quote:t})},Je=async()=>{var t,o;if(le.quote)try{await g.post(`/quotes/${le.quote.id}/convert-to-order`,{}),m.success("Orçamento convertido em ordem de serviço com sucesso!"),ae({isOpen:!1,quote:null}),q()}catch(r){m.error(((o=(t=r.response)==null?void 0:t.data)==null?void 0:o.error)||"Erro ao converter orçamento"),ae({isOpen:!1,quote:null})}},Ke=t=>{ne(t),ie(!0)},Ze=()=>{q(),ie(!1),ne(null),m.success("Agendamento criado! Verifique a página de Agendamentos.",{duration:5e3})},We=async(t,o)=>{var r,l;try{await g.patch(`/quotes/${t}/status`,{status:o}),m.success("Status atualizado com sucesso!"),q()}catch(S){m.error(((l=(r=S.response)==null?void 0:r.data)==null?void 0:l.error)||"Erro ao atualizar status")}},x=t=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(t),be=t=>new Date(t).toLocaleDateString("pt-BR"),Fe=t=>new Date(t).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric"}),J=t=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:2,maximumFractionDigits:2}).format(t),Ie=async t=>{try{m.loading("Gerando PDF do orçamento...",{id:"export-quote-pdf"});const{default:o}=await st(async()=>{const{default:u}=await import("./pdf-vendor-BOaogWDS.js").then(W=>W.j);return{default:u}},[]),r=new o("p","mm","a4"),l=210,S=297,i=15;let n=i;const j=u=>n+u>S-i?(r.addPage(),n=i,!0):!1;let s=null;try{s=(await g.get("/workshop-info")).data}catch(u){console.error("Erro ao carregar informações da oficina:",u)}const De=s!=null&&s.logo_base64?50:40;if(r.setFillColor(59,130,246),r.rect(0,0,l,De,"F"),s!=null&&s.logo_base64)try{r.addImage(s.logo_base64,"PNG",i,5,30,30)}catch(u){console.error("Erro ao adicionar logo:",u)}r.setTextColor(255,255,255),r.setFontSize(s!=null&&s.name?16:24),r.setFont("helvetica","bold");const ot=(s==null?void 0:s.name)||"ORÇAMENTO";r.text(ot,s!=null&&s.logo_base64?i+35:l/2,(s!=null&&s.logo_base64,15),{align:s!=null&&s.logo_base64?"left":"center",maxWidth:s!=null&&s.logo_base64?l-i-60:l-2*i}),s!=null&&s.trade_name&&(r.setFontSize(12),r.setFont("helvetica","normal"),r.text(s.trade_name,s!=null&&s.logo_base64?i+35:l/2,22,{align:s!=null&&s.logo_base64?"left":"center",maxWidth:s!=null&&s.logo_base64?l-i-60:l-2*i})),r.setFontSize(18),r.setFont("helvetica","bold"),r.text(t.quote_number,l/2,s!=null&&s.logo_base64?35:28,{align:"center"}),n=De+10,r.setTextColor(30,41,59),r.setFontSize(10),r.setFont("helvetica","bold"),r.text("Dados do Orçamento",i,n),n+=8,r.setFont("helvetica","normal"),r.setFontSize(9),[["Status:",ye(t.status)],["Data de Criação:",Fe(t.created_at)],t.valid_until?["Válido até:",Fe(t.valid_until)]:null].filter(Boolean).forEach(([u,W])=>{j(8),r.setFont("helvetica","bold"),r.text(u,i,n),r.setFont("helvetica","normal"),r.text(W,i+40,n),n+=6}),n+=5,j(20),r.setFont("helvetica","bold"),r.setFontSize(10),r.text("Cliente",i,n),n+=8,r.setFont("helvetica","normal"),r.setFontSize(9),r.text(t.client_name||"-",i,n),n+=6,r.setFont("helvetica","bold"),r.setFontSize(10),r.text("Veículo",i,n),n+=8,r.setFont("helvetica","normal"),r.setFontSize(9);const it=`${t.vehicle_brand||""} ${t.vehicle_model||""}`.trim();r.text(it||"-",i,n),t.vehicle_plate&&(n+=6,r.text(`Placa: ${t.vehicle_plate}`,i,n)),n+=6,n+=5,j(30),r.setFont("helvetica","bold"),r.setFontSize(10),r.text("Itens do Orçamento",i,n),n+=8;let me=t;(!t.items||t.items.length===0)&&(me=(await g.get(`/quotes/${t.id}`)).data),me.items&&me.items.length>0?(r.setFillColor(248,250,252),r.rect(i,n-5,l-2*i,8,"F"),r.setFontSize(8),r.setFont("helvetica","bold"),r.text("Item",i+2,n),r.text("Qtd",l-i-70,n),r.text("Unit.",l-i-50,n),r.text("Total",l-i-25,n),n+=8,r.setFont("helvetica","normal"),me.items.forEach((u,W)=>{j(10),W%2===0?r.setFillColor(255,255,255):r.setFillColor(248,250,252),r.rect(i,n-4,l-2*i,7,"F"),r.setFontSize(8),r.text(u.description||"-",i+2,n),r.text(u.quantity.toLocaleString("pt-BR",{minimumFractionDigits:2,maximumFractionDigits:2}),l-i-70,n,{align:"right"}),r.text(J(u.unit_price),l-i-50,n,{align:"right"}),r.text(J(u.total_price),l-i-25,n,{align:"right"}),n+=7})):(r.setFontSize(9),r.text("Nenhum item adicionado",i,n),n+=6),n+=5,j(25),r.setFont("helvetica","bold"),r.setFontSize(10),r.text("Resumo Financeiro",i,n),n+=8,r.setFontSize(9),r.setFont("helvetica","normal"),r.text("Subtotal:",l-i-50,n),r.text(J(t.subtotal),l-i-5,n,{align:"right"}),n+=7,t.discount>0&&(r.text("Desconto:",l-i-50,n),r.text(J(t.discount),l-i-5,n,{align:"right"}),n+=7),r.setFillColor(59,130,246,.1),r.rect(i,n-5,l-2*i,8,"F"),r.setFont("helvetica","bold"),r.setFontSize(11),r.setTextColor(59,130,246),r.text("TOTAL:",l-i-50,n),r.text(J(t.total),l-i-5,n,{align:"right"}),r.setTextColor(30,41,59),n+=10,j(20),t.notes&&(r.setFont("helvetica","bold"),r.setFontSize(10),r.text("Observações",i,n),n+=8,r.setFont("helvetica","normal"),r.setFontSize(9),r.splitTextToSize(t.notes,l-2*i).forEach(W=>{j(6),r.text(W,i,n),n+=6}),n+=5);const Te=r.getNumberOfPages();for(let u=1;u<=Te;u++){r.setPage(u),r.setFontSize(8),r.setTextColor(100,116,139);const W=(s==null?void 0:s.footer_text)||`Página ${u} de ${Te} - Gerado em ${new Date().toLocaleString("pt-BR")}`;if(r.text(W,l/2,S-10,{align:"center",maxWidth:l-2*i}),s&&(s.phone||s.email||s.address_city)){let M="";s.phone&&(M+=`Tel: ${s.phone}`),s.email&&(M+=(M?" | ":"")+`Email: ${s.email}`),s.address_city&&(M+=(M?" | ":"")+`${s.address_city}${s.address_state?"/"+s.address_state:""}`),M&&(r.setFontSize(7),r.text(M,l/2,S-5,{align:"center",maxWidth:l-2*i}))}}const nt=`ORCAMENTO_${t.quote_number}_${new Date().toISOString().split("T")[0]}.pdf`;r.save(nt),m.success("PDF gerado com sucesso!",{id:"export-quote-pdf"})}catch(o){console.error("Erro ao gerar PDF:",o),m.error("Erro ao gerar PDF do orçamento",{id:"export-quote-pdf"})}},ye=t=>({open:"Aberto",approved:"Aprovado",rejected:"Rejeitado",converted:"Convertido"})[t]||t,ce=t=>({open:"#3b82f6",approved:"#10b981",rejected:"#ef4444",converted:"#64748b"})[t]||"#64748b",je=a.useMemo(()=>T.reduce((t,o)=>t+o.total_price,0),[T]),ve=parseFloat(p.discount)||0,et=je-ve;a.useEffect(()=>{},[je,ve]),a.useEffect(()=>{p.client_id?_e(parseInt(p.client_id)):ee([])},[p.client_id]),a.useEffect(()=>{if(d.item_type==="product"&&d.product_id){const t=H.find(o=>o.id===parseInt(d.product_id));t&&v({...d,description:t.name,unit_price:t.sale_price.toString()})}else if(d.item_type==="labor"&&d.labor_id){const t=U.find(o=>o.id===parseInt(d.labor_id));t&&v({...d,description:t.name,unit_price:t.price.toString()})}},[d.product_id,d.labor_id,d.item_type]);const V=a.useMemo(()=>I.filter(t=>{if(y&&t.status!==y)return!1;if(b){const o=b.toLowerCase();return t.quote_number.toLowerCase().includes(o)||t.client_name&&t.client_name.toLowerCase().includes(o)||t.vehicle_plate&&t.vehicle_plate.toLowerCase().includes(o)}return!0}),[I,b,y]),tt=a.useMemo(()=>{const t=(L-1)*A;return V.slice(t,t+A)},[V,L,A]),rt=Math.ceil(V.length/A);return e.jsxs("div",{children:[e.jsxs("div",{style:{marginBottom:"2rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsx("h1",{style:{fontSize:"1.875rem",fontWeight:"bold",color:"#1e293b",marginBottom:"0.5rem"},children:"Orçamentos"}),e.jsx("p",{style:{color:"#64748b",fontSize:"0.9rem"},children:"Gerencie orçamentos de serviços"})]}),e.jsxs("button",{onClick:()=>{de(),P(!0)},style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.75rem 1.5rem",backgroundColor:"#f97316",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:"600"},children:[e.jsx(Pe,{size:20}),"Novo Orçamento"]})]}),e.jsxs("div",{style:{marginBottom:"1.5rem",display:"flex",gap:"1rem",flexWrap:"wrap",alignItems:"center"},children:[e.jsxs("div",{style:{position:"relative",flex:"1",minWidth:"250px",maxWidth:"400px"},children:[e.jsx(gt,{size:20,style:{position:"absolute",left:"12px",top:"50%",transform:"translateY(-50%)",color:"#64748b"}}),e.jsx("input",{type:"text",placeholder:"Buscar orçamentos...",value:b,onChange:t=>R(t.target.value),style:{width:"100%",padding:"0.75rem 1rem 0.75rem 2.5rem",border:"1px solid #e2e8f0",borderRadius:"8px",fontSize:"0.9rem",outline:"none"}})]}),e.jsxs("select",{value:y,onChange:t=>re(t.target.value),style:{padding:"0.75rem 1rem",border:"1px solid #e2e8f0",borderRadius:"8px",fontSize:"0.9rem",outline:"none",cursor:"pointer"},children:[e.jsx("option",{value:"",children:"Todos os status"}),e.jsx("option",{value:"open",children:"Aberto"}),e.jsx("option",{value:"approved",children:"Aprovado"}),e.jsx("option",{value:"rejected",children:"Rejeitado"}),e.jsx("option",{value:"converted",children:"Convertido"})]})]}),e.jsx("div",{style:{backgroundColor:"white",borderRadius:"12px",boxShadow:"0 1px 3px 0 rgb(0 0 0 / 0.1)",overflow:"hidden"},children:te?e.jsx(vt,{type:"table"}):V.length===0?e.jsx("div",{style:{padding:"3rem",textAlign:"center",color:"#64748b"},children:"Nenhum orçamento encontrado"}):e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{backgroundColor:"#f8fafc",borderBottom:"1px solid #e2e8f0"},children:[e.jsx("th",{style:{padding:"1rem",textAlign:"left",fontSize:"0.875rem",fontWeight:"600",color:"#64748b"},children:"Número"}),e.jsx("th",{style:{padding:"1rem",textAlign:"left",fontSize:"0.875rem",fontWeight:"600",color:"#64748b"},children:"Cliente"}),e.jsx("th",{style:{padding:"1rem",textAlign:"left",fontSize:"0.875rem",fontWeight:"600",color:"#64748b"},children:"Veículo"}),e.jsx("th",{style:{padding:"1rem",textAlign:"right",fontSize:"0.875rem",fontWeight:"600",color:"#64748b"},children:"Total"}),e.jsx("th",{style:{padding:"1rem",textAlign:"center",fontSize:"0.875rem",fontWeight:"600",color:"#64748b"},children:"Status"}),e.jsx("th",{style:{padding:"1rem",textAlign:"center",fontSize:"0.875rem",fontWeight:"600",color:"#64748b"},children:"Validade"}),e.jsx("th",{style:{padding:"1rem",textAlign:"center",fontSize:"0.875rem",fontWeight:"600",color:"#64748b"},children:"Ações"})]})}),e.jsx("tbody",{children:tt.map(t=>e.jsxs("tr",{style:{borderBottom:"1px solid #e2e8f0",transition:"background-color 0.2s"},onMouseEnter:o=>{o.currentTarget.style.backgroundColor="#f8fafc"},onMouseLeave:o=>{o.currentTarget.style.backgroundColor="white"},children:[e.jsx("td",{style:{padding:"1rem"},children:e.jsx("span",{style:{fontWeight:"600",color:"#1e293b"},children:t.quote_number})}),e.jsx("td",{style:{padding:"1rem",color:"#64748b"},children:t.client_name}),e.jsxs("td",{style:{padding:"1rem",color:"#64748b",fontSize:"0.875rem"},children:[t.vehicle_brand," ",t.vehicle_model," ",t.vehicle_plate&&`- ${t.vehicle_plate}`]}),e.jsx("td",{style:{padding:"1rem",textAlign:"right",fontWeight:"600",color:"#1e293b"},children:x(t.total)}),e.jsx("td",{style:{padding:"1rem",textAlign:"center"},children:e.jsx("span",{style:{fontSize:"0.75rem",padding:"0.25rem 0.75rem",borderRadius:"12px",fontWeight:"600",backgroundColor:ce(t.status)+"20",color:ce(t.status)},children:ye(t.status)})}),e.jsx("td",{style:{padding:"1rem",textAlign:"center",color:"#64748b",fontSize:"0.875rem"},children:t.valid_until?be(t.valid_until):"-"}),e.jsx("td",{style:{padding:"1rem"},children:e.jsxs("div",{style:{display:"flex",gap:"0.5rem",justifyContent:"center"},children:[e.jsx("button",{onClick:()=>{N(t.id),_(!0)},style:{padding:"0.5rem",backgroundColor:"#f1f5f9",border:"none",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},title:"Visualizar",children:e.jsx(ft,{size:16,color:"#64748b"})}),e.jsx("button",{onClick:()=>Ie(t),style:{padding:"0.5rem",backgroundColor:"#fef3c7",border:"none",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},title:"Gerar PDF",children:e.jsx(Ee,{size:16,color:"#d97706"})}),t.status!=="converted"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>Ue(t),style:{padding:"0.5rem",backgroundColor:"#f1f5f9",border:"none",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},title:"Editar",children:e.jsx(ht,{size:16,color:"#64748b"})}),t.status==="open"&&e.jsxs(e.Fragment,{children:[((F==null?void 0:F.profile)==="admin"||(F==null?void 0:F.profile)==="attendant")&&e.jsx("button",{onClick:()=>Ke(t),style:{padding:"0.5rem",backgroundColor:"#fff7ed",border:"none",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},title:"Aprovar e Agendar",children:e.jsx(xt,{size:16,color:"#f97316"})}),e.jsx("button",{onClick:()=>we(t),style:{padding:"0.5rem",backgroundColor:"#10b98120",border:"none",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},title:"Converter em OS",children:e.jsx(Me,{size:16,color:"#10b981"})})]}),e.jsx("button",{onClick:()=>Ye(t),style:{padding:"0.5rem",backgroundColor:"#fee2e2",border:"none",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},title:"Excluir",children:e.jsx(bt,{size:16,color:"#ef4444"})})]})]})})]},t.id))})]})}),!te&&V.length>0&&e.jsx(St,{currentPage:L,totalPages:rt,onPageChange:oe,totalItems:V.length,itemsPerPage:A}),e.jsx($e,{isOpen:Q.isOpen,title:"Confirmar Exclusão",message:((Re=Q.quote)==null?void 0:Re.status)==="converted"?`Atenção: O orçamento "${(ke=Q.quote)==null?void 0:ke.quote_number}" já foi convertido em ordem de serviço. Tem certeza que deseja excluí-lo? Esta ação não pode ser desfeita e não afetará a ordem de serviço já criada.`:`Tem certeza que deseja excluir o orçamento "${(Ae=Q.quote)==null?void 0:Ae.quote_number}"? Esta ação não pode ser desfeita.`,confirmText:"Excluir",cancelText:"Cancelar",type:"danger",onConfirm:Xe,onCancel:()=>se({isOpen:!1,quote:null})}),e.jsx($e,{isOpen:le.isOpen,title:"Converter Orçamento em OS",message:`Deseja converter o orçamento "${(Be=le.quote)==null?void 0:Be.quote_number}" em uma Ordem de Serviço?`,confirmText:"Converter",cancelText:"Cancelar",type:"info",onConfirm:Je,onCancel:()=>ae({isOpen:!1,quote:null})}),fe&&e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:"1rem"},onClick:()=>{P(!1),de()},children:e.jsxs("div",{style:{backgroundColor:"white",borderRadius:"12px",padding:"2rem",width:"90%",maxWidth:"800px",maxHeight:"90vh",overflowY:"auto"},onClick:t=>t.stopPropagation(),children:[e.jsx("h2",{style:{marginBottom:"1.5rem",fontSize:"1.5rem",fontWeight:"bold"},children:w?"Editar Orçamento":"Novo Orçamento"}),e.jsxs("form",{onSubmit:Ve,children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem",marginBottom:"1rem"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.875rem",fontWeight:"600"},children:"Cliente *"}),e.jsxs("select",{value:p.client_id,onChange:t=>O({...p,client_id:t.target.value,vehicle_id:""}),required:!0,disabled:!!w,style:{width:"100%",padding:"0.75rem",border:"1px solid #e2e8f0",borderRadius:"8px",fontSize:"0.9rem"},children:[e.jsx("option",{value:"",children:"Selecione um cliente"}),Z.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.875rem",fontWeight:"600"},children:"Veículo *"}),e.jsxs("select",{value:p.vehicle_id,onChange:t=>O({...p,vehicle_id:t.target.value}),required:!0,disabled:!!w||!p.client_id,style:{width:"100%",padding:"0.75rem",border:"1px solid #e2e8f0",borderRadius:"8px",fontSize:"0.9rem"},children:[e.jsx("option",{value:"",children:"Selecione um veículo"}),$.filter(t=>t.client_id===parseInt(p.client_id)).map(t=>e.jsxs("option",{value:t.id,children:[t.brand," ",t.model," ",t.plate&&`- ${t.plate}`]},t.id))]})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"1rem",marginBottom:"1rem"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.875rem",fontWeight:"600"},children:"Status"}),e.jsxs("select",{value:p.status,onChange:t=>O({...p,status:t.target.value}),disabled:(w==null?void 0:w.status)==="converted",style:{width:"100%",padding:"0.75rem",border:"1px solid #e2e8f0",borderRadius:"8px",fontSize:"0.9rem"},children:[e.jsx("option",{value:"open",children:"Aberto"}),e.jsx("option",{value:"approved",children:"Aprovado"}),e.jsx("option",{value:"rejected",children:"Rejeitado"})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.875rem",fontWeight:"600"},children:"Desconto (R$)"}),e.jsx("input",{type:"number",step:"0.01",min:"0",value:p.discount,onChange:t=>O({...p,discount:t.target.value}),style:{width:"100%",padding:"0.75rem",border:"1px solid #e2e8f0",borderRadius:"8px",fontSize:"0.9rem"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.875rem",fontWeight:"600"},children:"Válido até"}),e.jsx("input",{type:"date",value:p.valid_until,onChange:t=>O({...p,valid_until:t.target.value}),style:{width:"100%",padding:"0.75rem",border:"1px solid #e2e8f0",borderRadius:"8px",fontSize:"0.9rem"}})]})]}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.875rem",fontWeight:"600"},children:"Observações"}),e.jsx("textarea",{value:p.notes,onChange:t=>O({...p,notes:t.target.value}),rows:3,style:{width:"100%",padding:"0.75rem",border:"1px solid #e2e8f0",borderRadius:"8px",fontSize:"0.9rem",resize:"vertical"}})]}),e.jsxs("div",{style:{marginBottom:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("h3",{style:{fontSize:"1rem",fontWeight:"600"},children:"Itens do Orçamento"}),e.jsxs("button",{type:"button",onClick:()=>h(!0),style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem 1rem",backgroundColor:"#3b82f6",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:"600",fontSize:"0.875rem"},children:[e.jsx(Pe,{size:16}),"Adicionar Item"]})]}),T.length>0?e.jsx("div",{style:{marginBottom:"1.5rem",border:"1px solid #e2e8f0",borderRadius:"8px",overflow:"hidden"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{backgroundColor:"#f8fafc"},children:[e.jsx("th",{style:{padding:"0.75rem",textAlign:"left",fontSize:"0.875rem",fontWeight:"600",color:"#64748b"},children:"Tipo"}),e.jsx("th",{style:{padding:"0.75rem",textAlign:"left",fontSize:"0.875rem",fontWeight:"600",color:"#64748b"},children:"Descrição"}),e.jsx("th",{style:{padding:"0.75rem",textAlign:"center",fontSize:"0.875rem",fontWeight:"600",color:"#64748b"},children:"Qtd"}),e.jsx("th",{style:{padding:"0.75rem",textAlign:"right",fontSize:"0.875rem",fontWeight:"600",color:"#64748b"},children:"Preço Unit."}),e.jsx("th",{style:{padding:"0.75rem",textAlign:"right",fontSize:"0.875rem",fontWeight:"600",color:"#64748b"},children:"Total"}),e.jsx("th",{style:{padding:"0.75rem",textAlign:"center",fontSize:"0.875rem",fontWeight:"600",color:"#64748b"},children:"Ações"})]})}),e.jsx("tbody",{children:T.map(t=>e.jsxs("tr",{style:{borderTop:"1px solid #e2e8f0"},children:[e.jsx("td",{style:{padding:"0.75rem"},children:t.item_type==="product"?e.jsx(yt,{size:16,color:"#3b82f6"}):e.jsx(jt,{size:16,color:"#f97316"})}),e.jsx("td",{style:{padding:"0.75rem",fontSize:"0.875rem",color:"#1e293b"},children:t.description}),e.jsx("td",{style:{padding:"0.75rem",textAlign:"center",fontSize:"0.875rem",color:"#64748b"},children:t.quantity}),e.jsx("td",{style:{padding:"0.75rem",textAlign:"right",fontSize:"0.875rem",color:"#64748b"},children:x(t.unit_price)}),e.jsx("td",{style:{padding:"0.75rem",textAlign:"right",fontWeight:"600",fontSize:"0.875rem",color:"#1e293b"},children:x(t.total_price)}),e.jsx("td",{style:{padding:"0.75rem",textAlign:"center"},children:e.jsx("button",{type:"button",onClick:()=>Ge(t.id),style:{padding:"0.5rem",backgroundColor:"#fee2e2",border:"none",borderRadius:"6px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(Se,{size:16,color:"#ef4444"})})})]},t.id))})]})}):e.jsx("div",{style:{padding:"2rem",textAlign:"center",color:"#64748b",marginBottom:"1.5rem",border:"1px dashed #e2e8f0",borderRadius:"8px"},children:'Nenhum item adicionado. Clique em "Adicionar Item" para começar.'}),e.jsxs("div",{style:{marginBottom:"1.5rem",padding:"1rem",backgroundColor:"#f8fafc",borderRadius:"8px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"0.5rem"},children:[e.jsx("span",{style:{fontSize:"0.875rem",color:"#64748b"},children:"Subtotal:"}),e.jsx("span",{style:{fontSize:"0.875rem",fontWeight:"600",color:"#1e293b"},children:x(je)})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"0.5rem"},children:[e.jsx("span",{style:{fontSize:"0.875rem",color:"#64748b"},children:"Desconto:"}),e.jsxs("span",{style:{fontSize:"0.875rem",fontWeight:"600",color:"#ef4444"},children:["- ",x(ve)]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",paddingTop:"0.5rem",borderTop:"2px solid #e2e8f0"},children:[e.jsx("span",{style:{fontSize:"1rem",fontWeight:"600",color:"#1e293b"},children:"Total:"}),e.jsx("span",{style:{fontSize:"1.25rem",fontWeight:"bold",color:"#10b981"},children:x(et)})]})]}),e.jsxs("div",{style:{display:"flex",gap:"1rem",justifyContent:"flex-end"},children:[e.jsx("button",{type:"button",onClick:()=>{P(!1),de()},style:{padding:"0.75rem 1.5rem",backgroundColor:"#f1f5f9",color:"#64748b",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:"600"},children:"Cancelar"}),e.jsx("button",{type:"submit",style:{padding:"0.75rem 1.5rem",backgroundColor:"#f97316",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:"600"},children:w?"Atualizar":"Criar"})]})]})]})}),c&&e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1001},onClick:()=>{h(!1),xe()},children:e.jsxs("div",{style:{backgroundColor:"white",borderRadius:"12px",padding:"2rem",width:"90%",maxWidth:"500px"},onClick:t=>t.stopPropagation(),children:[e.jsx("h3",{style:{marginBottom:"1.5rem",fontSize:"1.25rem",fontWeight:"bold"},children:"Adicionar Item"}),e.jsxs("form",{onSubmit:He,children:[e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.875rem",fontWeight:"600"},children:"Tipo de Item"}),e.jsxs("select",{value:d.item_type,onChange:t=>v({...d,item_type:t.target.value,product_id:"",labor_id:"",description:"",unit_price:"0"}),style:{width:"100%",padding:"0.75rem",border:"1px solid #e2e8f0",borderRadius:"8px",fontSize:"0.9rem"},children:[e.jsx("option",{value:"product",children:"Produto"}),e.jsx("option",{value:"labor",children:"Mão de Obra"})]})]}),d.item_type==="product"?e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.875rem",fontWeight:"600"},children:"Produto"}),e.jsxs("select",{value:d.product_id,onChange:t=>v({...d,product_id:t.target.value}),style:{width:"100%",padding:"0.75rem",border:"1px solid #e2e8f0",borderRadius:"8px",fontSize:"0.9rem"},children:[e.jsx("option",{value:"",children:"Selecione um produto"}),H.map(t=>e.jsxs("option",{value:t.id,children:[t.name," - ",x(t.sale_price)]},t.id))]})]}):e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.875rem",fontWeight:"600"},children:"Mão de Obra"}),e.jsxs("select",{value:d.labor_id,onChange:t=>v({...d,labor_id:t.target.value}),style:{width:"100%",padding:"0.75rem",border:"1px solid #e2e8f0",borderRadius:"8px",fontSize:"0.9rem"},children:[e.jsx("option",{value:"",children:"Selecione um serviço"}),U.map(t=>e.jsxs("option",{value:t.id,children:[t.name," - ",x(t.price)]},t.id))]})]}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.875rem",fontWeight:"600"},children:"Descrição *"}),e.jsx("input",{type:"text",value:d.description,onChange:t=>v({...d,description:t.target.value}),required:!0,style:{width:"100%",padding:"0.75rem",border:"1px solid #e2e8f0",borderRadius:"8px",fontSize:"0.9rem"}})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem",marginBottom:"1rem"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.875rem",fontWeight:"600"},children:"Quantidade *"}),e.jsx("input",{type:"number",step:"0.01",min:"0.01",value:d.quantity,onChange:t=>v({...d,quantity:t.target.value}),required:!0,style:{width:"100%",padding:"0.75rem",border:"1px solid #e2e8f0",borderRadius:"8px",fontSize:"0.9rem"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.875rem",fontWeight:"600"},children:"Preço Unitário *"}),e.jsx("input",{type:"number",step:"0.01",min:"0",value:d.unit_price,onChange:t=>v({...d,unit_price:t.target.value}),required:!0,style:{width:"100%",padding:"0.75rem",border:"1px solid #e2e8f0",borderRadius:"8px",fontSize:"0.9rem"}})]})]}),e.jsxs("div",{style:{display:"flex",gap:"1rem",justifyContent:"flex-end"},children:[e.jsx("button",{type:"button",onClick:()=>{h(!1),xe()},style:{padding:"0.75rem 1.5rem",backgroundColor:"#f1f5f9",color:"#64748b",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:"600"},children:"Cancelar"}),e.jsx("button",{type:"submit",style:{padding:"0.75rem 1.5rem",backgroundColor:"#3b82f6",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:"600"},children:"Adicionar"})]})]})]})}),B&&E&&e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1002,padding:"1rem"},onClick:()=>{_(!1),N(null)},children:e.jsx("div",{style:{backgroundColor:"white",borderRadius:"12px",padding:"2rem",width:"90%",maxWidth:"800px",maxHeight:"90vh",overflowY:"auto"},onClick:t=>t.stopPropagation(),children:(()=>{const t=I.find(r=>r.id===E),o=Le||t;return o?e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start",marginBottom:"1.5rem"},children:[e.jsxs("div",{children:[e.jsx("h2",{style:{fontSize:"1.5rem",fontWeight:"bold",marginBottom:"0.5rem"},children:o.quote_number}),e.jsxs("div",{style:{display:"flex",gap:"1rem",alignItems:"center",marginBottom:"0.5rem"},children:[e.jsx("span",{style:{fontSize:"0.75rem",padding:"0.25rem 0.75rem",borderRadius:"12px",fontWeight:"600",backgroundColor:ce(o.status)+"20",color:ce(o.status)},children:ye(o.status)}),e.jsxs("span",{style:{fontSize:"0.875rem",color:"#64748b"},children:["Criado em ",be(o.created_at)]})]})]}),e.jsx("button",{onClick:()=>{_(!1),N(null)},style:{padding:"0.5rem",backgroundColor:"#f1f5f9",border:"none",borderRadius:"6px",cursor:"pointer"},children:e.jsx(Se,{size:20,color:"#64748b"})})]}),e.jsx("div",{style:{marginBottom:"1.5rem"},children:e.jsxs("div",{style:{padding:"1rem",backgroundColor:"#f8fafc",borderRadius:"8px"},children:[e.jsx("div",{style:{fontSize:"0.875rem",color:"#64748b",marginBottom:"0.25rem"},children:"Cliente"}),e.jsx("div",{style:{fontSize:"1rem",fontWeight:"600",color:"#1e293b"},children:o.client_name}),e.jsx("div",{style:{fontSize:"0.875rem",color:"#64748b",marginTop:"0.5rem",marginBottom:"0.25rem"},children:"Veículo"}),e.jsxs("div",{style:{fontSize:"1rem",fontWeight:"600",color:"#1e293b"},children:[o.vehicle_brand," ",o.vehicle_model," ",o.vehicle_plate&&`- ${o.vehicle_plate}`]}),o.valid_until&&e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{fontSize:"0.875rem",color:"#64748b",marginTop:"0.5rem",marginBottom:"0.25rem"},children:"Válido até"}),e.jsx("div",{style:{fontSize:"1rem",fontWeight:"600",color:"#1e293b"},children:be(o.valid_until)})]})]})}),o.items&&o.items.length>0&&e.jsxs("div",{style:{marginBottom:"1.5rem"},children:[e.jsx("h3",{style:{fontSize:"1rem",fontWeight:"600",marginBottom:"1rem"},children:"Itens"}),e.jsx("div",{style:{border:"1px solid #e2e8f0",borderRadius:"8px",overflow:"hidden"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{backgroundColor:"#f8fafc"},children:[e.jsx("th",{style:{padding:"0.75rem",textAlign:"left",fontSize:"0.875rem",fontWeight:"600",color:"#64748b"},children:"Descrição"}),e.jsx("th",{style:{padding:"0.75rem",textAlign:"center",fontSize:"0.875rem",fontWeight:"600",color:"#64748b"},children:"Qtd"}),e.jsx("th",{style:{padding:"0.75rem",textAlign:"right",fontSize:"0.875rem",fontWeight:"600",color:"#64748b"},children:"Preço Unit."}),e.jsx("th",{style:{padding:"0.75rem",textAlign:"right",fontSize:"0.875rem",fontWeight:"600",color:"#64748b"},children:"Total"})]})}),e.jsx("tbody",{children:o.items.map(r=>e.jsxs("tr",{style:{borderTop:"1px solid #e2e8f0"},children:[e.jsx("td",{style:{padding:"0.75rem",fontSize:"0.875rem",color:"#1e293b"},children:r.description}),e.jsx("td",{style:{padding:"0.75rem",textAlign:"center",fontSize:"0.875rem",color:"#64748b"},children:r.quantity}),e.jsx("td",{style:{padding:"0.75rem",textAlign:"right",fontSize:"0.875rem",color:"#64748b"},children:x(r.unit_price)}),e.jsx("td",{style:{padding:"0.75rem",textAlign:"right",fontWeight:"600",fontSize:"0.875rem",color:"#1e293b"},children:x(r.total_price)})]},r.id))})]})})]}),e.jsxs("div",{style:{padding:"1rem",backgroundColor:"#f8fafc",borderRadius:"8px",marginBottom:"1.5rem"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"0.5rem"},children:[e.jsx("span",{style:{fontSize:"0.875rem",color:"#64748b"},children:"Subtotal:"}),e.jsx("span",{style:{fontSize:"0.875rem",fontWeight:"600",color:"#1e293b"},children:x(o.subtotal)})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"0.5rem"},children:[e.jsx("span",{style:{fontSize:"0.875rem",color:"#64748b"},children:"Desconto:"}),e.jsxs("span",{style:{fontSize:"0.875rem",fontWeight:"600",color:"#ef4444"},children:["- ",x(o.discount)]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",paddingTop:"0.5rem",borderTop:"2px solid #e2e8f0"},children:[e.jsx("span",{style:{fontSize:"1rem",fontWeight:"600",color:"#1e293b"},children:"Total:"}),e.jsx("span",{style:{fontSize:"1.25rem",fontWeight:"bold",color:"#10b981"},children:x(o.total)})]})]}),o.notes&&e.jsxs("div",{style:{marginBottom:"1.5rem"},children:[e.jsx("h3",{style:{fontSize:"1rem",fontWeight:"600",marginBottom:"0.5rem"},children:"Observações"}),e.jsx("div",{style:{padding:"1rem",backgroundColor:"#f8fafc",borderRadius:"8px",fontSize:"0.875rem",color:"#64748b"},children:o.notes})]}),e.jsxs("div",{style:{display:"flex",gap:"1rem",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("button",{onClick:()=>Ie(o),style:{padding:"0.75rem 1.5rem",backgroundColor:"#fef3c7",color:"#d97706",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:"600",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(Ee,{size:18}),"Gerar PDF"]}),o.status!=="converted"&&e.jsxs("div",{style:{display:"flex",gap:"1rem"},children:[o.status==="open"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>{We(o.id,"approved"),_(!1),N(null)},style:{padding:"0.75rem 1.5rem",backgroundColor:"#10b981",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:"600"},children:"Aprovar"}),e.jsx("button",{onClick:()=>{We(o.id,"rejected"),_(!1),N(null)},style:{padding:"0.75rem 1.5rem",backgroundColor:"#ef4444",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:"600"},children:"Rejeitar"})]}),o.status==="approved"&&e.jsxs("button",{onClick:()=>{we(o),_(!1),N(null)},style:{padding:"0.75rem 1.5rem",backgroundColor:"#3b82f6",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:"600",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(Me,{size:18}),"Converter em OS"]})]})]})]}):(E&&ze(E),e.jsx("div",{children:"Carregando..."}))})()})}),z&&D&&e.jsx(Ct,{quoteId:D.id,quoteNumber:D.quote_number,clientName:D.client_name,vehicleBrand:D.vehicle_brand,vehicleModel:D.vehicle_model,vehiclePlate:D.vehicle_plate,total:D.total,onClose:()=>{ie(!1),ne(null)},onSuccess:Ze})]})};export{At as default};
