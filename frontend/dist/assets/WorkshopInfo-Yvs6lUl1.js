import{a as j,j as e}from"./index-DNHKrThd.js";import{r as l}from"./react-vendor-BpgKpUzx.js";import{z as d,V as _,B as v,X as I,a2 as L,J as C,K as F,ag as T,Y as A,F as N,ad as O}from"./ui-vendor-yLLZ9URH.js";import{a as w,f as z,c as S,r as p,d as M}from"./formatters-CDm7_xvv.js";import"./pdf-vendor-BOaogWDS.js";const H=()=>{const[k,h]=l.useState(!0),[c,x]=l.useState(!1),[u,b]=l.useState(!1),[m,g]=l.useState(null),[r,s]=l.useState({name:"",trade_name:"",cnpj:"",state_registration:"",municipal_registration:"",phone:"",email:"",website:"",address_street:"",address_number:"",address_complement:"",address_neighborhood:"",address_city:"",address_state:"",address_zipcode:"",notes:"",terms_and_conditions:"",footer_text:""});l.useEffect(()=>{f()},[]);const f=async()=>{var t,a;try{h(!0);const o=(await j.get("/workshop-info")).data;s({name:o.name||"",trade_name:o.trade_name||"",cnpj:o.cnpj?S(o.cnpj):"",state_registration:o.state_registration||"",municipal_registration:o.municipal_registration||"",phone:o.phone?z(o.phone):"",email:o.email||"",website:o.website||"",address_street:o.address_street||"",address_number:o.address_number||"",address_complement:o.address_complement||"",address_neighborhood:o.address_neighborhood||"",address_city:o.address_city||"",address_state:o.address_state||"",address_zipcode:o.address_zipcode?w(o.address_zipcode):"",notes:o.notes||"",terms_and_conditions:o.terms_and_conditions||"",footer_text:o.footer_text||""}),o.logo_base64&&g(o.logo_base64)}catch(n){const o=((a=(t=n.response)==null?void 0:t.data)==null?void 0:a.error)||n.message||"Erro ao carregar informações da oficina";o.includes("não existe")||o.includes("does not exist")?d.error("Tabela workshop_info não encontrada. Execute a migration 008_add_workshop_info.sql no banco de dados.",{duration:8e3}):d.error(o),console.error("Erro ao carregar informações da oficina:",n)}finally{h(!1)}},E=async t=>{var a,n;if(t.preventDefault(),!r.name.trim()){d.error("Nome da oficina é obrigatório");return}try{x(!0);const o={name:r.name.trim(),trade_name:r.trade_name.trim()||null,cnpj:r.cnpj?p(r.cnpj):null,state_registration:r.state_registration.trim()||null,municipal_registration:r.municipal_registration.trim()||null,phone:r.phone?p(r.phone):null,email:r.email.trim()||null,website:r.website.trim()||null,address_street:r.address_street.trim()||null,address_number:r.address_number.trim()||null,address_complement:r.address_complement.trim()||null,address_neighborhood:r.address_neighborhood.trim()||null,address_city:r.address_city.trim()||null,address_state:r.address_state.trim().toUpperCase()||null,address_zipcode:r.address_zipcode?p(r.address_zipcode):null,notes:r.notes.trim()||null,terms_and_conditions:r.terms_and_conditions.trim()||null,footer_text:r.footer_text.trim()||null};m?o.logo_base64=m:o.logo_base64=null,await j.put("/workshop-info",o),d.success("Informações da oficina atualizadas com sucesso!"),f()}catch(o){const i=(a=o.response)==null?void 0:a.data;if(i!=null&&i.errors&&Array.isArray(i.errors)){const P=i.errors.map(y=>y.message||y.msg).join(", ");d.error(`Erro de validação: ${P}`,{duration:6e3})}else d.error((i==null?void 0:i.error)||o.message||"Erro ao salvar informações da oficina");console.error("Erro ao salvar informações da oficina:",((n=o.response)==null?void 0:n.data)||o)}finally{x(!1)}},R=t=>{var o;const a=(o=t.target.files)==null?void 0:o[0];if(!a)return;if(!a.type.startsWith("image/")){d.error("Por favor, selecione uma imagem");return}if(a.size>2*1024*1024){d.error("A imagem deve ter no máximo 2MB");return}const n=new FileReader;n.onloadend=()=>{const i=n.result;g(i),d.success("Logo carregado com sucesso!")},n.onerror=()=>{d.error("Erro ao carregar imagem")},n.readAsDataURL(a)},B=()=>{g(null),d.success("Logo removido")},W=async t=>{const a=w(t);if(s({...r,address_zipcode:a}),p(t).length===8){b(!0);try{const o=await M(a);o?(s(i=>({...i,address_zipcode:a,address_street:o.logradouro||i.address_street,address_neighborhood:o.bairro||i.address_neighborhood,address_city:o.localidade||i.address_city,address_state:o.uf||i.address_state})),d.success("Endereço preenchido automaticamente!")):d.error("CEP não encontrado")}catch(o){console.error("Erro ao buscar CEP:",o),d.error("Erro ao buscar CEP. Tente novamente.")}finally{b(!1)}}};return k?e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"50vh"},children:e.jsx(_,{size:32,style:{animation:"spin 1s linear infinite",color:"#f97316"}})}):e.jsxs("div",{children:[e.jsxs("div",{style:{marginBottom:"2rem"},children:[e.jsxs("h1",{style:{fontSize:"1.875rem",fontWeight:"bold",color:"#1e293b",marginBottom:"0.5rem",display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsx(v,{size:28,style:{color:"#f97316"}}),"Informações da Oficina"]}),e.jsx("p",{style:{color:"#64748b",fontSize:"0.9rem"},children:"Configure as informações da sua oficina para uso em documentos, relatórios e cabeçalhos"})]}),m&&e.jsxs("div",{style:{marginBottom:"2rem",padding:"1.5rem",backgroundColor:"white",borderRadius:"12px",boxShadow:"0 1px 3px rgba(0,0,0,0.1)",display:"flex",alignItems:"center",gap:"1rem"},children:[e.jsxs("div",{style:{position:"relative"},children:[e.jsx("img",{src:m,alt:"Logo da Oficina",style:{maxWidth:"150px",maxHeight:"150px",objectFit:"contain",borderRadius:"8px",border:"2px solid #e2e8f0"}}),e.jsx("button",{onClick:B,style:{position:"absolute",top:"-8px",right:"-8px",backgroundColor:"#ef4444",color:"white",border:"none",borderRadius:"50%",width:"24px",height:"24px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 2px 4px rgba(0,0,0,0.2)"},children:e.jsx(I,{size:14})})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:"600",color:"#1e293b",marginBottom:"0.25rem"},children:"Logo da Oficina"}),e.jsx("div",{style:{fontSize:"0.875rem",color:"#64748b"},children:"Este logo aparecerá nos documentos impressos"})]})]}),e.jsxs("form",{onSubmit:E,children:[e.jsxs("div",{style:{display:"grid",gap:"2rem"},children:[e.jsxs("div",{style:{backgroundColor:"white",borderRadius:"12px",padding:"2rem",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[e.jsxs("h2",{style:{fontSize:"1.25rem",fontWeight:"600",color:"#1e293b",marginBottom:"1.5rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(v,{size:20,style:{color:"#f97316"}}),"Dados Básicos"]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem"},children:[e.jsxs("div",{style:{gridColumn:"1 / -1"},children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"500",color:"#374151"},children:"Logo da Oficina"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[e.jsxs("label",{style:{display:"inline-flex",alignItems:"center",gap:"0.5rem",padding:"0.75rem 1.5rem",backgroundColor:"#f97316",color:"white",borderRadius:"8px",cursor:"pointer",fontWeight:"500",transition:"background-color 0.2s"},children:[e.jsx(L,{size:18}),m?"Alterar Logo":"Enviar Logo",e.jsx("input",{type:"file",accept:"image/*",onChange:R,style:{display:"none"}})]}),e.jsx("span",{style:{fontSize:"0.875rem",color:"#64748b"},children:"PNG, JPG ou GIF (máx. 2MB)"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"500",color:"#374151"},children:["Nome da Oficina ",e.jsx("span",{style:{color:"#ef4444"},children:"*"})]}),e.jsx("input",{type:"text",value:r.name,onChange:t=>s({...r,name:t.target.value}),required:!0,style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"8px",fontSize:"0.875rem"},placeholder:"Ex: Oficina Mecânica Silva"})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"500",color:"#374151"},children:"Nome Fantasia"}),e.jsx("input",{type:"text",value:r.trade_name,onChange:t=>s({...r,trade_name:t.target.value}),style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"8px",fontSize:"0.875rem"},placeholder:"Ex: Auto Center Silva"})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"500",color:"#374151"},children:"CNPJ"}),e.jsx("input",{type:"text",value:r.cnpj,onChange:t=>{const a=S(t.target.value);s({...r,cnpj:a})},maxLength:18,style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"8px",fontSize:"0.875rem"},placeholder:"00.000.000/0000-00"})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"500",color:"#374151"},children:"Inscrição Estadual"}),e.jsx("input",{type:"text",value:r.state_registration,onChange:t=>s({...r,state_registration:t.target.value}),style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"8px",fontSize:"0.875rem"},placeholder:"000.000.000.000"})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"500",color:"#374151"},children:"Inscrição Municipal"}),e.jsx("input",{type:"text",value:r.municipal_registration,onChange:t=>s({...r,municipal_registration:t.target.value}),style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"8px",fontSize:"0.875rem"},placeholder:"0000000"})]})]})]}),e.jsxs("div",{style:{backgroundColor:"white",borderRadius:"12px",padding:"2rem",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[e.jsxs("h2",{style:{fontSize:"1.25rem",fontWeight:"600",color:"#1e293b",marginBottom:"1.5rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(C,{size:20,style:{color:"#f97316"}}),"Informações de Contato"]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem"},children:[e.jsxs("div",{children:[e.jsxs("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"500",color:"#374151"},children:[e.jsx(C,{size:16,style:{display:"inline",marginRight:"0.25rem"}}),"Telefone"]}),e.jsx("input",{type:"text",value:r.phone,onChange:t=>{const a=z(t.target.value);s({...r,phone:a})},style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"8px",fontSize:"0.875rem"},placeholder:"(00) 00000-0000"})]}),e.jsxs("div",{children:[e.jsxs("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"500",color:"#374151"},children:[e.jsx(F,{size:16,style:{display:"inline",marginRight:"0.25rem"}}),"Email"]}),e.jsx("input",{type:"email",value:r.email,onChange:t=>s({...r,email:t.target.value}),style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"8px",fontSize:"0.875rem"},placeholder:"contato@oficina.com"})]}),e.jsxs("div",{children:[e.jsxs("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"500",color:"#374151"},children:[e.jsx(T,{size:16,style:{display:"inline",marginRight:"0.25rem"}}),"Website"]}),e.jsx("input",{type:"url",value:r.website,onChange:t=>s({...r,website:t.target.value}),style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"8px",fontSize:"0.875rem"},placeholder:"https://www.oficina.com"})]})]})]}),e.jsxs("div",{style:{backgroundColor:"white",borderRadius:"12px",padding:"2rem",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[e.jsxs("h2",{style:{fontSize:"1.25rem",fontWeight:"600",color:"#1e293b",marginBottom:"1.5rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(A,{size:20,style:{color:"#f97316"}}),"Endereço"]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))",gap:"1.5rem"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"500",color:"#374151"},children:"CEP"}),e.jsx("input",{type:"text",value:r.address_zipcode,onChange:t=>W(t.target.value),maxLength:9,disabled:u,style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"8px",fontSize:"0.875rem",backgroundColor:u?"#f8fafc":"white"},placeholder:"00000-000"})]}),e.jsxs("div",{style:{gridColumn:"span 2"},children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"500",color:"#374151"},children:"Rua/Avenida"}),e.jsx("input",{type:"text",value:r.address_street,onChange:t=>s({...r,address_street:t.target.value}),style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"8px",fontSize:"0.875rem"},placeholder:"Rua Exemplo"})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"500",color:"#374151"},children:"Número"}),e.jsx("input",{type:"text",value:r.address_number,onChange:t=>s({...r,address_number:t.target.value}),style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"8px",fontSize:"0.875rem"},placeholder:"123"})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"500",color:"#374151"},children:"Complemento"}),e.jsx("input",{type:"text",value:r.address_complement,onChange:t=>s({...r,address_complement:t.target.value}),style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"8px",fontSize:"0.875rem"},placeholder:"Sala 101"})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"500",color:"#374151"},children:"Bairro"}),e.jsx("input",{type:"text",value:r.address_neighborhood,onChange:t=>s({...r,address_neighborhood:t.target.value}),style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"8px",fontSize:"0.875rem"},placeholder:"Centro"})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"500",color:"#374151"},children:"Cidade"}),e.jsx("input",{type:"text",value:r.address_city,onChange:t=>s({...r,address_city:t.target.value}),style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"8px",fontSize:"0.875rem"},placeholder:"Porto Alegre"})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"500",color:"#374151"},children:"Estado (UF)"}),e.jsx("input",{type:"text",value:r.address_state,onChange:t=>s({...r,address_state:t.target.value.toUpperCase().slice(0,2)}),maxLength:2,style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"8px",fontSize:"0.875rem",textTransform:"uppercase"},placeholder:"RS"})]})]})]}),e.jsxs("div",{style:{backgroundColor:"white",borderRadius:"12px",padding:"2rem",boxShadow:"0 1px 3px rgba(0,0,0,0.1)"},children:[e.jsxs("h2",{style:{fontSize:"1.25rem",fontWeight:"600",color:"#1e293b",marginBottom:"1.5rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(N,{size:20,style:{color:"#f97316"}}),"Textos e Observações"]}),e.jsxs("div",{style:{display:"grid",gap:"1.5rem"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"500",color:"#374151"},children:"Texto do Rodapé (para documentos)"}),e.jsx("textarea",{value:r.footer_text,onChange:t=>s({...r,footer_text:t.target.value}),rows:3,style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"8px",fontSize:"0.875rem",fontFamily:"inherit",resize:"vertical"},placeholder:"Este documento foi gerado automaticamente pelo sistema de gestão."}),e.jsx("p",{style:{fontSize:"0.75rem",color:"#64748b",marginTop:"0.25rem"},children:"Este texto aparecerá no rodapé dos PDFs gerados"})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"500",color:"#374151"},children:"Termos e Condições Padrão"}),e.jsx("textarea",{value:r.terms_and_conditions,onChange:t=>s({...r,terms_and_conditions:t.target.value}),rows:6,style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"8px",fontSize:"0.875rem",fontFamily:"inherit",resize:"vertical"},placeholder:"Termos e condições padrão para documentos..."})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"500",color:"#374151"},children:"Observações Gerais"}),e.jsx("textarea",{value:r.notes,onChange:t=>s({...r,notes:t.target.value}),rows:4,style:{width:"100%",padding:"0.75rem",border:"1px solid #d1d5db",borderRadius:"8px",fontSize:"0.875rem",fontFamily:"inherit",resize:"vertical"},placeholder:"Observações internas sobre a oficina..."})]})]})]})]}),e.jsx("div",{style:{marginTop:"2rem",display:"flex",justifyContent:"flex-end"},children:e.jsx("button",{type:"submit",disabled:c,style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.75rem 2rem",backgroundColor:c?"#cbd5e1":"#f97316",color:"white",border:"none",borderRadius:"8px",fontSize:"1rem",fontWeight:"600",cursor:c?"not-allowed":"pointer",transition:"background-color 0.2s"},children:c?e.jsxs(e.Fragment,{children:[e.jsx(_,{size:20,style:{animation:"spin 1s linear infinite"}}),"Salvando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(O,{size:20}),"Salvar Informações"]})})})]}),e.jsx("style",{children:`
        @keyframes spin {
          from { transform: rotate(0deg); }
          to { transform: rotate(360deg); }
        }
      `})]})};export{H as default};
